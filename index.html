<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cervecería Artesanal Medalla. Descubre nuestras variedades Golden, Honey, IPA, Scottish y Stout. Alquiler de barriles y el mejor ambiente en nuestro Taproom.">
    <meta name="theme-color" content="#0f172a">
    
    <!-- Favicon con el logo de Medalla -->
    <link rel="icon" href="./logo_medalla.png" type="image/png">
    
    <title>Cervecería MEDALLA | Cerveza Artesanal Premium</title>

    <!-- SEO & Social Media (Open Graph) -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cerveceriamedalla.com/">
    <meta property="og:title" content="Cervecería MEDALLA | Sabor de Victoria">
    <meta property="og:description" content="Artesanía pura. Ingredientes seleccionados. Descubre nuestras variedades y visita nuestro Taproom.">
    <meta property="og:image" content="https://image.pollinations.ai/prompt/beer%20golden%20glass%20cinematic?width=1200&height=630&nologo=true">

    <!-- Performance Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://image.pollinations.ai">

    <!-- Leaflet CSS (Mapa) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>

    <!-- React & ReactDOM (Production Versions for Speed) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Leaflet JS (Mapa) -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Custom Config & Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;600&family=Roboto:wght@300;400;500&display=swap');
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #0f172a;
            color: #f1f5f9;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4, .brand-font {
            font-family: 'Oswald', sans-serif;
        }

        /* Glassmorphism */
        .glass {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        .glass-strong {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Text Gradients */
        .gold-text {
            background: linear-gradient(to right, #fbbf24, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .animate-float { animation: float 4s ease-in-out infinite; }

        /* New Animations for Modals (Open) */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }

        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        .animate-zoomIn { animation: zoomIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* New Animations for Modals (Close) */
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        .animate-fadeOut { animation: fadeOut 0.3s ease-in forwards; }

        @keyframes zoomOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.9); }
        }
        .animate-zoomOut { animation: zoomOut 0.3s ease-in forwards; }

        /* Scroll Reveal */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 1s cubic-bezier(0.5, 0, 0, 1);
        }
        .reveal.active { opacity: 1; transform: translateY(0); }

        .beer-card {
            transition: all 0.3s ease;
        }

        .beer-card:hover {
            /* Se eliminó el transform: translateY(-5px) para quitar el movimiento */
            box-shadow: 0 20px 25px -5px rgba(251, 191, 36, 0.15), 0 10px 10px -5px rgba(251, 191, 36, 0.1);
            filter: brightness(1.1); /* Aumenta un poco el brillo */
            border-color: rgba(251, 191, 36, 0.4);
        }

        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1e293b; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #fbbf24; }

        /* Ocultar scrollbar para carruseles móviles pero mantener funcionalidad */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Toast Animations */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideIn 0.3s ease-out forwards; }

        /* Audio Bars */
        @keyframes sound {
            0% { height: 3px; } 50% { height: 100%; } 100% { height: 3px; }
        }
        .bar {
            width: 3px; background: #fbbf24;
            animation: sound 0ms -800ms linear infinite alternate;
        }
        
        /* Leaflet custom styles */
        .leaflet-popup-content-wrapper {
            background: #1e293b;
            color: #f1f5f9;
            border: 1px solid #fbbf24;
        }
        .leaflet-popup-tip {
            background: #fbbf24;
        }
        
        .content-section { content-visibility: auto; }
    </style>
</head>
<body>
    <div id="root">
        <div style="padding: 20px; color: white; text-align: center;">
            <h1>Cervecería Medalla</h1>
            <p>Cargando...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const ModalPortal = ({ children }) => ReactDOM.createPortal(children, document.body);

        // URL del Logo
        const logoUrl = "./logo_medalla.png";

        // --- HOOKS & UTILS ---
        const useScrollReveal = () => {
            useEffect(() => {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('active');
                    });
                }, { threshold: 0.1 });
                document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
                return () => observer.disconnect();
            }, []);
        };

        // Custom Hook para LocalStorage
        const useLocalStorage = (key, initialValue) => {
            const [storedValue, setStoredValue] = useState(() => {
                try {
                    const item = window.localStorage.getItem(key);
                    return item ? JSON.parse(item) : initialValue;
                } catch (error) {
                    console.error(error);
                    return initialValue;
                }
            });
            const setValue = (value) => {
                try {
                    const valueToStore = value instanceof Function ? value(storedValue) : value;
                    setStoredValue(valueToStore);
                    window.localStorage.setItem(key, JSON.stringify(valueToStore));
                } catch (error) {
                    console.error(error);
                }
            };
            return [storedValue, setValue];
        };

        // --- DATA ---
        const TOOLTIPS = {
            ABV: "Alcohol por Volumen: Indica el porcentaje de alcohol en la bebida.",
            IBU: "International Bitterness Units: Escala que mide el amargor percibido del lúpulo.",
            SRM: "Standard Reference Method: Sistema para especificar el color de la cerveza."
        };

        const beersData = [
            { id: 1, name: "GOLDEN", titleImg: "./golden.png", persona: "AMELIA", category: "Rubias", style: "Golden Ale", abv: "4.5%", ibu: 14, srm: 5, color: "bg-yellow-500", img: "./lata_golden.png", detailImg: "./info_golden.png", tags: ["Refrescante", "Suave", "Balanceada"] },
            { id: 2, name: "HONEY", titleImg: "./honey.png", persona: "MARY", category: "Rubias", style: "Honey Beer", abv: "5.5%", ibu: 12, srm: 7, color: "bg-orange-500", img: "./lata_honey.png", detailImg: "./info_honey.png", tags: ["Dulce", "Miel Orgánica", "Suave"] },
            { id: 3, name: "RED IPA", titleImg: "./red_ipa.png", persona: "VALENTINA", category: "IPAs", style: "Red India Pale Ale", abv: "6.0%", ibu: 48, srm: 14, color: "bg-red-600", img: "./lata_red_ipa.png", detailImg: "./info_red_ipa.png", tags: ["Amarga", "Frutal", "Caramelo"] },
            { id: 4, name: "ROCK IPA", titleImg: "./rock_ipa.png", persona: "MARÍA TERESA", category: "IPAs", style: "American IPA", abv: "6.2%", ibu: 50, srm: 6, color: "bg-emerald-600", img: "./lata_rock_ipa.png", detailImg: "./info_rock_ipa.png", tags: ["Cítrica", "Resinosa", "Intensa"] },
            { id: 5, name: "SCOTTISH", titleImg: "./scottish.png", persona: "MARIE", category: "Rojas", style: "Scottish Ale", abv: "5.0%", ibu: 20, srm: 15, color: "bg-purple-600", img: "./lata_scottish.png", detailImg: "./info_scottish.png", tags: ["Maltosa", "Caramelo", "Cobriza"] },
            { id: 6, name: "STOUT", titleImg: "./stout.png", persona: "AURA", category: "Negras", style: "Stout", abv: "6.0%", ibu: 25, srm: 32, color: "bg-[#e07a5f]", img: "./lata_stout.png", detailImg: "./info_stout.png", tags: ["Robusta", "Café", "Avena"] }
        ];
        const productsData = [
            { id: "p1", name: "Growler 1.9L", price: 12000, img: "https://image.pollinations.ai/prompt/amber%20glass%20beer%20growler%20minimal%20studio?width=300&height=300&nologo=true", tag: "Esencial" },
            { id: "p2", name: "Remera 'Lúpulo'", price: 18500, img: "https://image.pollinations.ai/prompt/black%20t-shirt%20with%20hop%20graphic%20design%20folded?width=300&height=300&nologo=true", tag: "Edición" },
            { id: "p3", name: "Copa Dublin", price: 6500, img: "https://image.pollinations.ai/prompt/beer%20glass%20tulip%20empty%20studio%20lighting?width=300&height=300&nologo=true", tag: "Cristalería" },
            { id: "p4", name: "Gorra Trucker", price: 10000, img: "https://image.pollinations.ai/prompt/black%20trucker%20hat%20cap%20mockup?width=300&height=300&nologo=true", tag: "Style" }
        ];
        const kegsData = [
            { size: "10 Litros", serves: "~20 Pintas", ideal: "Cenas, Previas", price: "Consultar", iconSize: 48, stock: 100 },
            { size: "20 Litros", serves: "~40 Pintas", ideal: "Cumpleaños, Reuniones", price: "Consultar", iconSize: 56, stock: 50 },
            { size: "50 Litros", serves: "~100 Pintas", ideal: "Fiestas, Casamientos", price: "Consultar", iconSize: 64, stock: 20 }
        ];
        const partnersData = [
            // --- CASA CENTRAL (OFICIALES) ---
            { name: "Fábrica Medalla", type: "Fábrica", location: "Freyre, Córdoba", address: "Gral. Roca 80, X2413", features: ["Venta Latas", "Alquiler Barriles"], varieties: ["Todas las Variedades"], lat: -31.16706, lng: -62.10053, isOfficial: true },
            { name: "Medalla Resto Bar", type: "Resto Bar", location: "Freyre, Córdoba", address: "25 de Mayo 903, X2413", features: ["Cerveza Tirada", "Recarga Growlers", "Venta Latas"], varieties: ["Todas las Variedades"], lat: -31.16679, lng: -62.10113, isOfficial: true },

            // BUENOS AIRES - CABA
            { name: "Bar La Estación", type: "Bar", location: "Palermo Soho, CABA", address: "Honduras 1234", features: ["Tirada", "Pintas"], varieties: ["GOLDEN", "SCOTTISH", "STOUT"], lat: -34.588, lng: -58.430 },
            { name: "Almacén de Birra", type: "Tienda", location: "Belgrano, CABA", address: "Juramento 4500", features: ["Recarga", "Latas"], varieties: ["Todas las Latas", "Recarga Growler"], lat: -34.561, lng: -58.456 },
            { name: "Burger Joint", type: "Restaurante", location: "San Telmo, CABA", address: "Defensa 800", features: ["Tirada"], varieties: ["RED IPA", "GOLDEN"], lat: -34.618, lng: -58.373 },
            { name: "Vinería y Lúpulo", type: "Tienda", location: "Caballito, CABA", address: "Av. La Plata 500", features: ["Latas", "Barriles"], varieties: ["Pack Degustación", "Alquiler Barril"], lat: -34.617, lng: -58.433 },
            { name: "Patio Cervecero", type: "Bar", location: "Puerto Madero, CABA", address: "Alicia Moreau de Justo 1200", features: ["Tirada", "Happy Hour"], varieties: ["HONEY", "SCOTTISH"], lat: -34.608, lng: -58.365 },
            { name: "Refugio del Lúpulo", type: "Bar", location: "Recoleta, CABA", address: "Junín 1400", features: ["Tirada", "Terraza"], varieties: ["ROCK IPA", "STOUT"], lat: -34.591, lng: -58.395 },
            { name: "Estación Growler", type: "Tienda", location: "Colegiales, CABA", address: "Av. Elcano 3000", features: ["Recarga", "Latas"], varieties: ["Todas las Latas"], lat: -34.574, lng: -58.458 },
            { name: "La Birrería", type: "Bar", location: "Villa Urquiza, CABA", address: "Av. Triunvirato 4200", features: ["Tirada", "Comida"], varieties: ["GOLDEN", "RED IPA"], lat: -34.578, lng: -58.482 },
            { name: "Hops & Dreams", type: "Bar", location: "Palermo Hollywood, CABA", address: "Nicaragua 5500", features: ["Tirada", "DJ"], varieties: ["ROCK IPA", "HONEY"], lat: -34.582, lng: -58.435 },

            // BUENOS AIRES - PROVINCIA
            { name: "El Galpón del Norte", type: "Bar", location: "San Isidro, GBA", address: "Av. Libertador 15000", features: ["Jardín", "Tirada"], varieties: ["GOLDEN", "SCOTTISH"], lat: -34.471, lng: -58.528 },
            { name: "Sur Birra", type: "Tienda", location: "Lanús, GBA", address: "25 de Mayo 400", features: ["Latas", "Barriles"], varieties: ["Todas las Latas"], lat: -34.705, lng: -58.393 },
            { name: "Cervecería Diagonal", type: "Bar", location: "La Plata, BSAS", address: "Diagonal 74 y 10", features: ["Tirada", "Artesanal"], varieties: ["STOUT", "RED IPA"], lat: -34.914, lng: -57.951 },
            { name: "Punto Pinta", type: "Tienda", location: "Quilmes, GBA", address: "Videla 200", features: ["Recarga"], varieties: ["Recarga Growler"], lat: -34.724, lng: -58.261 },
            { name: "Oeste Hops", type: "Bar", location: "Morón, GBA", address: "Sarmiento 800", features: ["Tirada", "Bandas"], varieties: ["ROCK IPA", "GOLDEN"], lat: -34.650, lng: -58.620 },

            // SANTA FE
            { name: "Rosario Hops", type: "Bar", location: "Pichincha, Rosario", address: "Bv. Oroño 40", features: ["Tirada", "Patio"], varieties: ["Todas las Variedades"], lat: -32.939, lng: -60.654 },
            { name: "La Fluvial", type: "Restaurante", location: "Costa, Rosario", address: "Av. de los Inmigrantes 410", features: ["Vista al Río", "Tirada"], varieties: ["GOLDEN", "HONEY"], lat: -32.949, lng: -60.627 },
            { name: "Santa Fe Store", type: "Tienda", location: "Centro, Santa Fe", address: "San Martín 2000", features: ["Latas", "Merch"], varieties: ["Todas las Latas"], lat: -31.635, lng: -60.705 },
            { name: "El Litoral Bar", type: "Bar", location: "Candioti, Santa Fe", address: "Bv. Gálvez 1500", features: ["Tirada", "Happy Hour"], varieties: ["SCOTTISH", "STOUT"], lat: -31.638, lng: -60.693 },

            // CÓRDOBA
            { name: "Güemes Birra", type: "Bar", location: "Güemes, Córdoba", address: "Belgrano 800", features: ["Tirada", "Arte"], varieties: ["ROCK IPA", "RED IPA"], lat: -31.424, lng: -64.193 },
            { name: "Cerro Point", type: "Tienda", location: "Cerro de las Rosas, Córdoba", address: "Av. Rafael Núñez 4500", features: ["Latas", "Recarga"], varieties: ["Pack Degustación"], lat: -31.372, lng: -64.225 },
            { name: "Lago Beer", type: "Restaurante", location: "Villa Carlos Paz, CBA", address: "Av. Costanera 100", features: ["Vista al Lago", "Tirada"], varieties: ["GOLDEN", "HONEY"], lat: -31.417, lng: -64.495 },
            { name: "Nueva Córdoba Tap", type: "Bar", location: "Nueva Córdoba, CBA", address: "Independencia 1100", features: ["Tirada", "Universitario"], varieties: ["STOUT", "SCOTTISH"], lat: -31.428, lng: -64.189 },
            { name: "La Cumbre Brew", type: "Tienda", location: "La Cumbre, CBA", address: "Caraffa 300", features: ["Latas", "Regionales"], varieties: ["Todas las Latas"], lat: -30.983, lng: -64.492 }
        ];
        
        const menuItemsData = {
            starters: [
                { name: "Papas Bravas Medalla", desc: "Con alioli de ajo negro y salsa picante de la casa.", price: 4500, pairing: "RED IPA" },
                { name: "Bastones de Muzza", desc: "Empanados en panko y hierbas, con salsa marinara.", price: 5200, pairing: "GOLDEN" },
                { name: "Nachos Completos", desc: "Cheddar fundido, guacamole, frijoles y jalapeños.", price: 6000, pairing: "ROCK IPA" }
            ],
            burgers: [
                { name: "La Campeona", desc: "Doble carne smash, cheddar, panceta, cebolla crispy y salsa BBQ.", price: 8500, pairing: "SCOTTISH" },
                { name: "Blue Cheese", desc: "Medallón de 180g, queso azul, rúcula y peras caramelizadas.", price: 8900, pairing: "HONEY" },
                { name: "Veggie Medalla", desc: "Medallón de lentejas y hongos, lechuga, tomate y mayo vegana.", price: 7800, pairing: "GOLDEN" }
            ],
            pizzas: [
                { name: "Fugazzeta Rellena", desc: "Mucha cebolla, mucho queso, base de masa madre.", price: 9000, pairing: "GOLDEN" },
                { name: "Pepperoni Spicy", desc: "Mozzarella, pepperoni y un toque de miel picante.", price: 9500, pairing: "ROCK IPA" },
                { name: "Napolitana", desc: "Tomate fresco, ajo, orégano y aceitunas negras.", price: 8200, pairing: "RED IPA" }
            ]
        };

        // --- COMPONENT: TILT CARD (Utilizado solo en MerchStore) ---
        const TiltCard = ({ children, className = "" }) => {
            const ref = useRef(null);
            const [rotate, setRotate] = useState({ x: 0, y: 0 });
            const [opacity, setOpacity] = useState(0);

            const handleMove = (e) => {
                if (!ref.current) return;
                const { left, top, width, height } = ref.current.getBoundingClientRect();
                const x = (e.clientX - left - width / 2) / 25;
                const y = -(e.clientY - top - height / 2) / 25;
                setRotate({ x, y });
                setOpacity(1);
            };

            return (
                <div ref={ref} onMouseMove={handleMove} onMouseLeave={() => { setRotate({x:0,y:0}); setOpacity(0); }} className={`transition-transform duration-200 ease-out transform-gpu perspective-1000 ${className}`} style={{ transform: `perspective(1000px) rotateX(${rotate.y}deg) rotateY(${rotate.x}deg)` }}>
                    {children}
                    <div className="absolute inset-0 pointer-events-none bg-gradient-to-tr from-transparent via-white/10 to-transparent z-20 mix-blend-overlay transition-opacity duration-200" style={{ opacity }} />
                </div>
            );
        };

        // --- COMPONENT: CONFIRMATION MODAL ---
        const ConfirmModal = ({ isOpen, onClose, onConfirm, title, message, confirmText = "Confirmar", cancelText = "Cancelar", isDestructive = false }) => {
            if (!isOpen) return null;
            return (
                <ModalPortal>
                    <div className="fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fadeIn" onClick={onClose}>
                        <div className="bg-slate-900 rounded-xl border border-slate-700 p-6 max-w-sm w-full shadow-2xl transform transition-all scale-100" onClick={e => e.stopPropagation()}>
                            <h3 className="text-xl font-bold text-white mb-2">{title}</h3>
                            <p className="text-slate-400 mb-6">{message}</p>
                            <div className="flex gap-3">
                                <button onClick={onClose} className="flex-1 px-4 py-2 rounded bg-slate-800 text-white hover:bg-slate-700 font-bold transition-colors cursor-pointer">{cancelText}</button>
                                <button onClick={onConfirm} className={`flex-1 px-4 py-2 rounded font-bold text-white transition-colors cursor-pointer ${isDestructive ? 'bg-red-600 hover:bg-red-500' : 'bg-amber-600 hover:bg-amber-500'}`}>{confirmText}</button>
                            </div>
                        </div>
                    </div>
                </ModalPortal>
            );
        };

        // --- COMPONENT: SOMMELIER IA MODAL ---
        const SommelierModal = ({ isOpen, onClose }) => {
            const [step, setStep] = useState(0);
            const [answers, setAnswers] = useState({});
            const [result, setResult] = useState(null);

            // Sommelier Data: 4 Preguntas para afinar el resultado
            const questions = [ 
                { 
                    id: 'intensity', 
                    text: "¿Qué buscas en tu cerveza hoy?", 
                    options: [{label: "Suave y Refrescante", val: 'light'}, {label: "Con Cuerpo y Carácter", val: 'heavy'}] 
                },
                { 
                    id: 'bitterness', 
                    text: "¿Qué tal te llevas con el amargor?", 
                    options: [{label: "Prefiero poco amargor", val: 'low'}, {label: "¡Amo el lúpulo amargo!", val: 'high'}] 
                }, 
                { 
                    id: 'sweetness', 
                    text: "¿Te gustan los toques dulces?", 
                    options: [{label: "Sí, me gusta lo dulce", val: 'sweet'}, {label: "No, prefiero seco/tostado", val: 'dry'}] 
                },
                {
                    id: 'color',
                    text: "¿Qué color te atrae más visualmente?",
                    options: [{label: "Doradas y Rubias", val: 'blonde'}, {label: "Rojas y Negras", val: 'dark'}]
                }
            ];

            const handleAnswer = (key, val) => {
                const newAnswers = { ...answers, [key]: val };
                setAnswers(newAnswers);
                
                if (step < questions.length - 1) { 
                    setStep(step + 1); 
                } else { 
                    // Lógica de Decisión para las 6 Variedades
                    let matchId = 1; // Default Golden

                    // 1. IPAs (Alto Amargor)
                    if (newAnswers.bitterness === 'high') {
                        if (newAnswers.color === 'dark' || newAnswers.intensity === 'heavy') {
                            matchId = 3; // RED IPA
                        } else {
                            matchId = 4; // ROCK IPA
                        }
                    } 
                    // 2. Bajas en Amargor
                    else {
                        if (newAnswers.color === 'blonde') {
                            if (newAnswers.sweetness === 'sweet') {
                                matchId = 2; // HONEY
                            } else {
                                matchId = 1; // GOLDEN
                            }
                        } else {
                            // Color Oscuro
                            if (newAnswers.sweetness === 'sweet' || newAnswers.intensity === 'heavy' && newAnswers.sweetness !== 'dry') {
                                matchId = 5; // SCOTTISH (Maltosa/Dulzona)
                            } else {
                                matchId = 6; // STOUT (Tostada/Seca)
                            }
                        }
                    }
                    
                    setResult(beersData.find(b => b.id === matchId) || beersData[0]); 
                }
            };
            
            const reset = () => { setStep(0); setAnswers({}); setResult(null); };

            if (!isOpen) return null;

            return (
                <ModalPortal>
                    <div className="fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-fadeIn" onClick={onClose}>
                        {/* Modal Container - Generous size on desktop */}
                        <div className="relative bg-slate-900 w-full h-full md:w-[90%] md:h-[80%] lg:w-[80vw] lg:h-[80vh] xl:max-w-6xl rounded-3xl overflow-hidden shadow-2xl border border-slate-700 flex flex-col md:flex-row" onClick={e => e.stopPropagation()}>
                            <button onClick={onClose} className="absolute top-6 right-6 z-50 p-2 bg-black/50 hover:bg-amber-600 rounded-full text-white transition-colors cursor-pointer"><Icon name="X" size={24} /></button>
                            
                            {/* Left Side: Image/Visual (Hidden on Mobile) */}
                            <div className="hidden md:flex md:w-1/2 bg-slate-800 relative items-center justify-center overflow-hidden">
                                <div className="absolute inset-0 opacity-40 bg-[url('https://image.pollinations.ai/prompt/elegant%20beer%20sommelier%20dark%20cinematic%20lighting?width=800&height=1200&nologo=true')] bg-cover bg-center"></div>
                                <div className="absolute inset-0 bg-gradient-to-r from-transparent to-slate-900"></div>
                                <div className="relative z-10 text-center p-10">
                                    <div className="inline-block p-4 rounded-full bg-amber-500/20 mb-6 backdrop-blur-sm border border-amber-500/30"><Icon name="BrainCircuit" size={48} className="text-amber-400" /></div>
                                    <h2 className="text-4xl lg:text-5xl font-bold text-white mb-4 brand-font">SOMMELIER <span className="gold-text">IA</span></h2>
                                    <p className="text-slate-300 text-lg">Descubre tu variedad ideal con nuestra inteligencia artificial cervecera.</p>
                                </div>
                            </div>

                            {/* Right Side: Quiz (Full width on Mobile) */}
                            <div className="w-full md:w-1/2 p-8 md:p-12 lg:p-16 flex flex-col justify-center bg-slate-900 relative">
                                
                                {/* Mobile Header */}
                                <div className="md:hidden text-center mb-8">
                                    <h2 className="text-3xl font-bold text-white mb-2 brand-font">SOMMELIER IA</h2>
                                    <p className="text-slate-400 text-sm">Encuentra tu cerveza perfecta.</p>
                                </div>

                                {!result ? (
                                    <div className="animate-fadeIn">
                                        <h3 className="text-2xl lg:text-3xl mb-8 font-light text-white text-center">{questions[step].text}</h3>
                                        <div className="flex flex-col gap-4">
                                            {questions[step].options.map((opt, idx) => (
                                                <button key={idx} onClick={() => handleAnswer(questions[step].id, opt.val)} className="w-full px-6 py-4 bg-slate-800 hover:bg-amber-600 border border-slate-700 hover:border-amber-500 rounded-xl transition-all transform hover:-translate-y-1 shadow-lg cursor-pointer text-white font-bold text-lg">
                                                    {opt.label}
                                                </button>
                                            ))}
                                        </div>
                                        <div className="mt-8 flex justify-center gap-2">
                                            {questions.map((_, i) => (
                                                <span key={i} className={`h-2 w-2 rounded-full transition-colors ${step >= i ? 'bg-amber-500' : 'bg-slate-700'}`}></span>
                                            ))}
                                        </div>
                                    </div>
                                ) : (
                                    <div className="animate-fadeIn bg-slate-900/80 p-8 rounded-2xl border border-amber-500/30 backdrop-blur-sm text-center">
                                        <p className="text-amber-500 uppercase tracking-widest text-sm mb-4 font-bold">Tu Match Perfecto:</p>
                                        <div className="mb-6 relative w-32 h-32 mx-auto">
                                            <div className="absolute inset-0 bg-amber-500/20 rounded-full blur-xl animate-pulse"></div>
                                            <img src={result.titleImg} alt={result.name} className="relative w-full h-full object-contain" />
                                        </div>
                                        <h3 className="text-4xl font-bold text-white mb-6 brand-font">{result.name}</h3>
                                        <p className="text-slate-400 mb-8">{result.tags.join(" • ")}</p>
                                        <div className="flex flex-col gap-4">
                                            <button onClick={() => { onClose(); window.location.href='#beers'; }} className="bg-amber-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-amber-500 cursor-pointer transition-colors uppercase tracking-wider">
                                                Ver en Catálogo
                                            </button>
                                            <button onClick={reset} className="text-slate-400 hover:text-white underline cursor-pointer text-sm">
                                                Volver a intentar
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </ModalPortal>
            );
        };

        // --- COMPONENT: EVENT GALLERY MODAL ---
        const EventGalleryModal = ({ isOpen, onClose, event }) => {
            const [selectedImage, setSelectedImage] = useState(0);

            // Generar imágenes simuladas si el evento existe
            const galleryImages = useMemo(() => {
                if (!event) return [];
                // Usamos la imagen principal y generamos 3 variaciones basadas en prompts similares para simular un álbum
                return [
                    event.img,
                    `https://image.pollinations.ai/prompt/party%20crowd%20having%20fun%20beer%20${event.title.split(' ')[0]}?width=800&height=600&nologo=true`,
                    `https://image.pollinations.ai/prompt/beer%20glasses%20cheers%20bar%20night%20${event.title.split(' ')[0]}?width=800&height=600&nologo=true`,
                    `https://image.pollinations.ai/prompt/people%20laughing%20drinking%20beer%20bar%20${event.title.split(' ')[0]}?width=800&height=600&nologo=true`
                ];
            }, [event]);

            // Resetear imagen seleccionada al abrir nuevo evento
            useEffect(() => {
                if (isOpen) setSelectedImage(0);
            }, [isOpen]);

            if (!isOpen || !event) return null;

            return (
                <ModalPortal>
                    <div className="fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/95 backdrop-blur-xl animate-fadeIn" onClick={onClose}>
                        <div className="relative w-full h-full max-w-7xl flex flex-col lg:flex-row gap-4 lg:gap-8 p-4" onClick={e => e.stopPropagation()}>
                            
                            <button onClick={onClose} className="absolute top-0 right-0 z-50 p-2 text-slate-400 hover:text-white transition-colors cursor-pointer"><Icon name="X" size={32} /></button>

                            {/* Main Image Viewer (Top on Mobile, Left on Desktop) */}
                            <div className="flex-1 relative rounded-2xl overflow-hidden bg-black flex items-center justify-center border border-slate-800 shadow-2xl order-1 lg:order-1 h-[50vh] lg:h-auto">
                                <img 
                                    src={galleryImages[selectedImage]} 
                                    alt={`Galería ${event.title} ${selectedImage + 1}`} 
                                    className="max-w-full max-h-full object-contain animate-fadeIn"
                                    key={selectedImage} // Force re-render for animation
                                />
                                <div className="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/80 to-transparent p-6">
                                    <h3 className="text-2xl font-bold text-white brand-font">{event.title}</h3>
                                    <p className="text-amber-500 font-mono text-sm">{event.date} • Foto {selectedImage + 1} de {galleryImages.length}</p>
                                </div>
                            </div>

                            {/* Thumbnails List (Bottom on Mobile, Right on Desktop) */}
                            <div className="lg:w-80 flex flex-row lg:flex-col gap-3 overflow-x-auto lg:overflow-y-auto custom-scrollbar order-2 lg:order-2 shrink-0 h-auto lg:h-full">
                                {galleryImages.map((img, idx) => (
                                    <div 
                                        key={idx} 
                                        onClick={() => setSelectedImage(idx)}
                                        className={`relative cursor-pointer rounded-lg overflow-hidden shrink-0 w-24 h-24 lg:w-full lg:h-48 transition-all duration-300 border-2 ${selectedImage === idx ? 'border-amber-500 opacity-100 scale-105' : 'border-transparent opacity-60 hover:opacity-100'}`}
                                    >
                                        <img src={img} alt={`Thumb ${idx}`} className="w-full h-full object-cover" />
                                    </div>
                                ))}
                            </div>

                        </div>
                    </div>
                </ModalPortal>
            );
        };

        // --- STANDARD COMPONENTS ---
        const Icon = ({ name, size = 24, className }) => {
            const icons = {
                Beer: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17 11h1a3 3 0 0 1 0 6h-1"/><path d="M9 12v6"/><path d="M13 12v6"/><path d="M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z"/><path d="M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8"/></svg>,
                Menu: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
                X: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
                Award: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
                Clock: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
                MapPin: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
                CheckCircle: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4 12 14.01l-3-3"/></svg>,
                BrainCircuit: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/><path d="M17.599 6.5a3 3 0 0 0 .399-1.375"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .585-.396"/><path d="M19.938 10.5a4 4 0 0 1 .585.396"/><path d="M6 18a4 4 0 0 1-1.97-3.284"/><path d="M17.97 14.716A4 4 0 0 1 16 18"/></svg>,
                ChevronRight: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m9 18 6-6-6-6"/></svg>,
                Star: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
                Calendar: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
                Camera: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>,
                Music: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>,
                Utensils: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
                Crown: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>,
                Gift: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="3" y="8" width="18" height="4" rx="1"/><path d="M12 8v13"/><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"/><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"/></svg>,
                Zap: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
                Quote: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/></svg>,
                Phone: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
                Map: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" x2="9" y1="3" y2="18"/><line x1="15" x2="15" y1="6" y2="21"/></svg>,
                Package: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22v-9"/></svg>,
                Wheat: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 22 16 8"/><path d="M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/><path d="M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/><path d="M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/><path d="M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z"/><path d="M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"/><path d="M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"/><path d="M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"/></svg>,
                Thermometer: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>,
                Flame: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>,
                FlaskConical: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2"/><path d="M8.5 2h7"/><path d="M7 16h10"/></svg>,
                ShoppingBag: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>,
                HelpCircle: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>,
                Plus: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
                Minus: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/></svg>,
                Volume2: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>,
                VolumeX: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" x2="17" y1="9" y2="15"/><line x1="17" x2="23" y1="9" y2="15"/></svg>,
                Play: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="5 3 19 12 5 21 5 3"/></svg>,
                Pause: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>,
                Trash: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 6h18"/><path d="M19 6v14c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V6"/><path d="M8 6V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2v2"/></svg>,
                Search: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
                Facebook: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>,
                Instagram: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/></svg>,
                Twitter: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/></svg>
            };
            return icons[name] || null;
        };

        const Toast = ({ message, type = 'success', onClose }) => {
            useEffect(() => {
                const t = setTimeout(onClose, 1500);
                return () => clearTimeout(t);
            }, [onClose]);
            return (
                <div className="toast-enter pointer-events-auto flex items-center gap-3 px-6 py-4 rounded-lg shadow-2xl bg-emerald-600 text-white border border-white/10 mb-3">
                    <Icon name="CheckCircle" size={20} /> <span className="font-bold text-sm">{message}</span>
                </div>
            );
        };

        const ToastContainer = ({ toasts, remove }) => (
            <ModalPortal>
                <div className="fixed bottom-5 right-5 z-[1000] flex flex-col items-end pointer-events-none">
                    {toasts.map(t => <Toast key={t.id} message={t.message} onClose={() => remove(t.id)} />)}
                </div>
            </ModalPortal>
        );

        const CartDrawer = ({ isOpen, onClose, cart, updateQuantity, remove, total, clearCart, onCheckout, addToCart }) => {
            const [activeTab, setActiveTab] = useState('cart'); // 'cart' | 'store'

            // Resetear a la pestaña del carrito cuando se abre el drawer
            useEffect(() => {
                if (isOpen) setActiveTab('cart');
            }, [isOpen]);

            if (!isOpen) return null;

            return (
                <ModalPortal>
                    <div className={`fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] transition-opacity duration-300 ${isOpen ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}`} onClick={onClose} />
                    <div className={`fixed top-0 right-0 h-full w-full sm:w-96 bg-slate-900 shadow-2xl border-l border-slate-700 z-[101] transform transition-transform duration-300 ease-in-out flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}>
                        
                        {/* Header */}
                        <div className="p-6 pb-0 bg-slate-900 z-20">
                            <div className="flex items-center justify-between mb-6">
                                <h3 className="text-xl font-bold text-white flex items-center gap-2"><Icon name="ShoppingBag" className="text-amber-500" /> MEDALLA</h3>
                                <div className="flex items-center gap-3">
                                    {cart.length > 0 && (
                                        <button 
                                            onClick={clearCart}
                                            className="text-xs text-red-400 hover:text-white bg-red-900/20 hover:bg-red-600 border border-red-900/50 rounded px-2 py-1 uppercase font-bold tracking-wider transition-colors cursor-pointer"
                                        >
                                            Vaciar
                                        </button>
                                    )}
                                    <button onClick={onClose} className="p-2 hover:bg-slate-800 rounded-full text-slate-400 hover:text-white cursor-pointer"><Icon name="X" size={20} /></button>
                                </div>
                            </div>

                            {/* Tabs */}
                            <div className="flex p-1 bg-slate-800 rounded-lg">
                                <button 
                                    onClick={() => setActiveTab('cart')}
                                    className={`flex-1 py-2 text-sm font-bold uppercase tracking-wider rounded-md transition-all ${activeTab === 'cart' ? 'bg-slate-700 text-white shadow-sm' : 'text-slate-400 hover:text-white'}`}
                                >
                                    Tu Pedido ({cart.length})
                                </button>
                                <button 
                                    onClick={() => setActiveTab('store')}
                                    className={`flex-1 py-2 text-sm font-bold uppercase tracking-wider rounded-md transition-all ${activeTab === 'store' ? 'bg-amber-600 text-white shadow-sm' : 'text-slate-400 hover:text-white'}`}
                                >
                                    El Arsenal
                                </button>
                            </div>
                        </div>

                        {/* Body Content */}
                        <div className="flex-1 overflow-y-auto p-6 space-y-4 custom-scrollbar">
                            
                            {/* VISTA: CARRITO */}
                            {activeTab === 'cart' && (
                                <>
                                    {cart.length === 0 ? (
                                        <div className="h-full flex flex-col items-center justify-center text-slate-500 text-center">
                                            <Icon name="ShoppingBag" size={48} className="mb-4 opacity-20" />
                                            <p className="mb-4">Tu arsenal está vacío.</p>
                                            <button onClick={() => setActiveTab('store')} className="text-amber-500 hover:text-amber-400 text-sm font-bold underline cursor-pointer">Ver Merchandising</button>
                                        </div>
                                    ) : (
                                        <div className="space-y-4">
                                            {cart.map((item) => (
                                                <div key={item.id} className="flex gap-4 bg-slate-800/50 p-3 rounded-lg border border-slate-700 animate-fadeIn">
                                                    <img src={item.img} alt={item.name} className="w-16 h-16 object-cover rounded bg-slate-900" />
                                                    <div className="flex-1">
                                                        <h4 className="text-white font-bold text-sm">{item.name}</h4>
                                                        <p className="text-amber-500 font-mono text-xs mb-2">${item.price.toLocaleString()}</p>
                                                        <div className="flex items-center gap-2 bg-slate-900 inline-flex rounded-md p-1 border border-slate-700">
                                                            <button onClick={() => updateQuantity(item.id, -1)} className="w-6 h-6 flex items-center justify-center text-slate-400 hover:text-white hover:bg-slate-700 rounded transition-colors cursor-pointer"><Icon name="Minus" size={12} /></button>
                                                            <span className="text-white text-xs font-bold w-6 text-center">{item.quantity}</span>
                                                            <button onClick={() => updateQuantity(item.id, 1)} className="w-6 h-6 flex items-center justify-center text-slate-400 hover:text-white hover:bg-slate-700 rounded transition-colors cursor-pointer"><Icon name="Plus" size={12} /></button>
                                                        </div>
                                                    </div>
                                                    <button onClick={() => remove(item.id)} className="text-slate-600 hover:text-red-500 self-start cursor-pointer"><Icon name="Trash" size={16} /></button>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </>
                            )}

                            {/* VISTA: TIENDA (EL ARSENAL) */}
                            {activeTab === 'store' && (
                                <div className="grid grid-cols-1 gap-4">
                                    {productsData.map((prod) => (
                                        <div key={prod.id} className="group bg-slate-800 rounded-xl overflow-hidden border border-slate-700 hover:border-amber-500/50 transition-all flex">
                                            <div className="w-24 h-24 bg-slate-900 shrink-0 relative">
                                                <img src={prod.img} alt={prod.name} className="w-full h-full object-cover" />
                                                <span className="absolute top-1 left-1 bg-black/70 text-white text-[8px] px-1 rounded uppercase font-bold">{prod.tag}</span>
                                            </div>
                                            <div className="p-3 flex flex-col justify-between flex-1">
                                                <div>
                                                    <h4 className="text-white font-bold text-sm">{prod.name}</h4>
                                                    <p className="text-amber-500 font-mono text-sm">${prod.price.toLocaleString()}</p>
                                                </div>
                                                <button 
                                                    onClick={() => { addToCart(prod); }} 
                                                    className="mt-2 w-full py-1.5 bg-slate-700 hover:bg-amber-600 text-white text-xs font-bold uppercase tracking-wider rounded transition-colors flex items-center justify-center gap-2 cursor-pointer"
                                                >
                                                    <Icon name="Plus" size={12} /> Agregar
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Footer (Solo visible en vista Carrito) */}
                        {activeTab === 'cart' && (
                            <div className="p-6 border-t border-slate-700 bg-slate-900 z-20">
                                <div className="flex justify-between items-end mb-4"><span className="text-slate-400 text-sm uppercase tracking-wider">Total</span><span className="text-2xl font-bold text-white">${total.toLocaleString()}</span></div>
                                <button 
                                    className={`w-full py-4 rounded font-bold uppercase tracking-widest transition-colors cursor-pointer ${cart.length === 0 ? 'bg-slate-800 text-slate-600' : 'bg-amber-600 hover:bg-amber-500 text-white'}`} 
                                    disabled={cart.length===0}
                                    onClick={onCheckout}
                                >
                                    Iniciar Pago
                                </button>
                            </div>
                        )}
                    </div>
                </ModalPortal>
            );
        };

        // --- SECTIONS & MISSING COMPONENTS ---
        const ScrollProgress = () => {
            const [scroll, setScroll] = useState(0);
            useEffect(() => {
                const onScroll = () => {
                    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                    setScroll((window.scrollY / height) * 100);
                };
                window.addEventListener('scroll', onScroll, { passive: true });
                return () => window.removeEventListener('scroll', onScroll);
            }, []);
            return <div className="fixed top-0 left-0 w-full h-1 z-[100] bg-slate-900"><div className="h-full bg-amber-500 transition-all duration-100" style={{ width: `${scroll}%` }}></div></div>;
        };

        const AgeGate = ({ onVerify }) => {
            const [visible, setVisible] = useState(() => {
                try {
                    return window.localStorage.getItem('medalla_age_verified') !== 'true';
                } catch (e) {
                    return true;
                }
            });
            
            const handleVerify = () => {
                window.localStorage.setItem('medalla_age_verified', 'true');
                setVisible(false);
                onVerify();
            };

            if (!visible) return null;
            
            return (
                <div className="fixed inset-0 z-[200] flex items-center justify-center bg-slate-950">
                    <div className="absolute inset-0 bg-black/80"></div>
                    
                    <div className="relative z-10 max-w-md w-full p-8 text-center">
                        <div className="mb-8">
                            <img src={logoUrl} alt="Logo Medalla" className="w-40 h-40 mx-auto object-contain drop-shadow-[0_0_25px_rgba(251,191,36,0.4)]" />
                        </div>
                        <h2 className="text-3xl md:text-4xl font-bold text-white mb-4 brand-font">CERVECERÍA <span className="gold-text">MEDALLA</span></h2>
                        <p className="text-slate-400 mb-8">El sabor de la victoria se disfruta con responsabilidad.</p>
                        <h3 className="text-xl text-white font-bold mb-8">¿SOS MAYOR DE 18 AÑOS?</h3>
                        <div className="flex flex-col gap-4">
                            <button onClick={handleVerify} className="w-full bg-amber-500 hover:bg-amber-400 text-slate-900 font-bold py-4 rounded-sm uppercase tracking-widest transition-all hover:scale-105 shadow-[0_0_20px_rgba(251,191,36,0.3)] cursor-pointer">SÍ, ENTRAR</button>
                            <button className="w-full bg-transparent border border-slate-700 text-slate-500 hover:text-white font-bold py-4 rounded-sm uppercase tracking-widest transition-colors cursor-pointer">NO, SALIR</button>
                        </div>
                    </div>
                </div>
            );
        };

        const RadioMedalla = () => {
            const [isPlaying, setIsPlaying] = useState(false);
            const [minimized, setMinimized] = useState(true);
            
            // Enlace Embed de Spotify
            const spotifyPlaylistUrl = "https://open.spotify.com/embed/playlist/37i9dQZF1DX9tPFwDMOaN1?utm_source=generator&theme=0";

            return (
                // Ajuste: bottom-4 en móvil (antes bottom-24) para bajar el elemento
                <div className={`fixed bottom-4 right-4 z-[90] transition-all duration-500 ${minimized ? 'w-12 h-12 rounded-full overflow-hidden' : 'w-80 rounded-xl'} glass-strong shadow-2xl border border-slate-700`}>
                    {minimized ? (
                        <button onClick={() => setMinimized(false)} className="w-full h-full flex items-center justify-center text-amber-500 hover:bg-white/10 cursor-pointer bg-slate-900">
                            <Icon name="Music" size={20} className="animate-pulse" />
                        </button>
                    ) : (
                        <div className="relative bg-slate-900 rounded-xl overflow-hidden flex flex-col">
                            <div className="flex justify-between items-center px-2 pt-2 pb-1 bg-slate-900 z-10">
                                <span className="text-[10px] font-bold text-amber-500 uppercase tracking-widest bg-black/50 px-2 py-1 rounded backdrop-blur-sm">Radio Medalla</span>
                                <button onClick={() => setMinimized(true)} className="bg-black/50 text-slate-400 hover:text-white rounded-full p-1 transition-colors cursor-pointer backdrop-blur-sm">
                                    <Icon name="Minus" size={14} />
                                </button>
                            </div>
                            
                            {/* Iframe de Spotify limpio */}
                            <div className="relative bg-black" style={{ minHeight: '152px' }}>
                                <iframe 
                                    style={{borderRadius: "12px"}} 
                                    src={spotifyPlaylistUrl} 
                                    width="100%" 
                                    height="152" 
                                    frameBorder="0" 
                                    allowFullScreen="" 
                                    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
                                    loading="lazy"
                                    className="bg-slate-900 relative z-10"
                                ></iframe>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const Navbar = ({ cartCount, onOpenCart, onOpenSommelier }) => {
            const [isOpen, setIsOpen] = useState(false);
            const [scrolled, setScrolled] = useState(false);

            useEffect(() => {
                const handleScroll = () => setScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll, { passive: true });
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            const navLinks = [
                { name: 'NOSOTROS', id: '#about' },
                { name: 'CERVEZAS', id: '#beers' },
                { name: 'EL RITUAL', id: '#process' },
                { name: 'BARRILES', id: '#kegs' },
                { name: 'DÓNDE', id: '#locator' },
                { name: 'EVENTOS', id: '#events' }, 
                { name: 'FAQ', id: '#faq' },      
            ];

            return (
                <nav className={`fixed w-full z-50 transition-all duration-300 ${scrolled || isOpen ? 'bg-slate-900/95 shadow-lg py-2' : 'bg-transparent py-4'}`}>
                    <div className="w-full px-4 md:px-8 lg:px-12 flex justify-between items-center gap-4">
                        {/* Logo con acción de cierre de menú */}
                        <a 
                            href="#home" 
                            onClick={() => setIsOpen(false)} 
                            className={`text-xl md:text-2xl font-bold flex items-center gap-2 md:gap-3 brand-font text-amber-500 hover:opacity-90 transition-all duration-500 whitespace-nowrap ${scrolled ? 'opacity-100 translate-y-0' : 'opacity-0 -translate-y-10 pointer-events-none'}`}
                        >
                            <img src={logoUrl} alt="Logo" className="h-8 w-8 md:h-10 md:w-10 object-contain" />
                            MEDALLA
                        </a>
                        
                        {/* Desktop Menu */}
                        <div className="hidden md:flex gap-6 lg:gap-8 font-medium text-sm tracking-widest flex-shrink-0 items-center">
                            {navLinks.map(link => (
                                <a 
                                    key={link.name} 
                                    href={link.id} 
                                    className="hover:text-amber-500 transition-colors cursor-pointer"
                                >
                                    {link.name}
                                </a>
                            ))}
                            {/* Sommelier Link Special Treatment */}
                            <button 
                                onClick={onOpenSommelier}
                                className="text-amber-500 hover:text-white transition-colors cursor-pointer font-bold border border-amber-500/50 hover:bg-amber-500/10 px-3 py-1 rounded-full text-xs"
                            >
                                SOMMELIER IA
                            </button>
                        </div>
                        
                        <div className="flex items-center gap-4 flex-shrink-0">
                            {/* Cart Button */}
                            <button 
                                onClick={onOpenCart}
                                className="relative p-2 text-white hover:text-amber-500 transition-colors cursor-pointer"
                            >
                                <Icon name="ShoppingBag" size={24} />
                                {cartCount > 0 && (
                                    <span className="absolute -top-1 -right-1 bg-amber-500 text-slate-900 text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center animate-bounce">
                                        {cartCount}
                                    </span>
                                )}
                            </button>

                            {/* Mobile Menu Button */}
                            <button className="md:hidden text-white cursor-pointer" onClick={() => setIsOpen(!isOpen)}>
                                <Icon name={isOpen ? "X" : "Menu"} />
                            </button>
                        </div>
                    </div>
                    
                    {/* Mobile Menu */}
                    <div className={`md:hidden absolute top-full left-0 w-full bg-slate-900 transition-all duration-300 overflow-hidden ${isOpen ? 'max-h-screen border-t border-slate-800 shadow-2xl' : 'max-h-0'}`}>
                         <div className="flex flex-col items-center py-4 gap-4 text-sm tracking-widest">
                            {navLinks.map(link => (
                                <a 
                                    key={link.name} 
                                    href={link.id} 
                                    onClick={() => setIsOpen(false)}
                                    className="hover:text-amber-500 transition-colors cursor-pointer"
                                >
                                    {link.name}
                                </a>
                            ))}
                            <button 
                                onClick={() => {
                                    setIsOpen(false);
                                    onOpenSommelier();
                                }}
                                className="text-amber-500 font-bold mt-2 border border-amber-500 px-4 py-2 rounded-full hover:bg-amber-500 hover:text-slate-900 transition-colors"
                            >
                                SOMMELIER IA
                            </button>
                        </div>
                    </div>
                </nav>
            );
        };

        const Hero = () => (
            // Ajuste: min-h-[100dvh] para móviles con py-24 para dar aire arriba y abajo.
            // En escritorio (md) se fuerza h-screen y se quita el padding extra para un centrado puro.
            <section id="home" className="relative min-h-[100dvh] flex items-center justify-center overflow-hidden content-section reveal active scroll-mt-28 py-24 md:h-screen md:py-0"> 
                {/* Fondo Móvil: Gradiente oscuro simple */}
                <div className="absolute inset-0 bg-gradient-to-b from-slate-950 via-black to-slate-950 z-0 md:hidden"></div>
                
                {/* Fondo Desktop (md+): Imagen bg_2.png con tratamiento */}
                <div className="hidden md:block absolute inset-0 z-0">
                    <img src="./bg_2.png" alt="Fondo Hero" className="w-full h-full object-cover opacity-60" />
                    {/* Overlay Gradiente para integrar con el resto de la web */}
                    <div className="absolute inset-0 bg-gradient-to-b from-slate-950/80 via-slate-950/40 to-slate-900"></div>
                    {/* Overlay Radial para resaltar el centro */}
                    <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_transparent_0%,_rgba(15,23,42,0.8)_100%)]"></div>
                </div>
                
                {/* Contenido */}
                <div className="relative z-10 text-center px-4 w-full flex flex-col items-center justify-center h-full">
                    
                    {/* Logo con sombra extra para destacar sobre la foto. Sin background en MD+ */}
                    <div className="mb-6 md:mb-8 flex justify-center mx-auto">
                        <div className="p-4 md:p-0 rounded-full bg-amber-500/10 md:bg-transparent backdrop-blur-md md:backdrop-blur-none shadow-[0_0_50px_rgba(251,191,36,0.2)] md:shadow-none border border-white/5 md:border-none">
                            <img src={logoUrl} alt="Logo Gigante" className="w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 object-contain drop-shadow-2xl" />
                        </div>
                    </div>

                    {/* Título con sombra de texto para legibilidad */}
                    <h1 className="text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold mb-8 md:mb-12 tracking-tighter mx-auto max-w-lg md:max-w-2xl lg:max-w-none lg:whitespace-nowrap drop-shadow-lg">
                        Una <span className="gold-text drop-shadow-sm">Medalla</span> como reconocimiento al valor
                    </h1>
                    
                    {/* Botones */}
                    <div className="flex flex-row gap-3 md:gap-5 justify-center w-full sm:w-auto px-2 sm:px-0">
                        <a href="#beers" className="flex-1 sm:flex-none px-4 py-3 md:px-8 md:py-3 bg-amber-600 hover:bg-amber-500 text-white font-bold rounded-sm transition-all tracking-widest uppercase cursor-pointer text-xs sm:text-sm md:text-base shadow-lg shadow-black/50 hover:-translate-y-1 text-center whitespace-nowrap border border-transparent">
                            Cervezas
                        </a>
                        <a href="#locator" className="flex-1 sm:flex-none px-4 py-3 md:px-8 md:py-3 border border-amber-500 bg-black/30 md:bg-transparent backdrop-blur-sm text-amber-500 hover:bg-amber-500 hover:text-white font-bold rounded-sm transition-all tracking-widest uppercase cursor-pointer text-xs sm:text-sm md:text-base hover:-translate-y-1 text-center whitespace-nowrap shadow-lg shadow-black/50">
                            Encontranos
                        </a>
                    </div>
                </div>
            </section>
        );

        const AboutUs = () => (
            // Ajuste de padding: pt para el navbar, pb reducido
            <section id="about" className="relative overflow-hidden content-section reveal pt-24 md:pt-28 pb-8">
                {/* Imagen de Fondo con Overlay */}
                <div className="absolute inset-0 z-0">
                    <img src="./bg_2.jpg" alt="Fábrica Medalla" className="w-full h-full object-cover" />
                    <div className="absolute inset-0 bg-slate-950/90 backdrop-blur-[2px]"></div>
                    <div className="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-slate-900"></div>
                </div>

                <div className="container mx-auto px-6 relative z-10">
                    <div className="max-w-4xl mx-auto text-center">
                        <div className="inline-block p-3 rounded-full bg-amber-500/10 mb-4 border border-amber-500/30 animate-float">
                           <Icon name="Award" size={32} className="text-amber-500" />
                        </div>
                        
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-6 leading-tight brand-font tracking-wide">
                            CUATRO TIPOS QUE VIVEN SIMPLE Y <span className="gold-text">SUEÑAN EN GRANDE</span>
                        </h2>
                        
                        <div className="space-y-4 text-base md:text-lg text-slate-300 font-light leading-relaxed text-justify md:text-center">
                            <p>
                                Un loco rockero con alma eterna de niño, fanático incomparable de la cerveza; comienza en el 2010 con su anhelado proyecto <strong className="text-amber-500 font-bold">MEDALLA</strong>. Tal vez no imaginó que el patio de su casa era el inicio de una eterna y refrescante gira.
                            </p>
                            <p>
                                En el camino se suman tres birreros: un ingeniero y lector empedernido, al que resulta casi imposible encontrarle un error de cálculo. El tercero es inquieto; relacionista público que va detectando oportunidades; y números también.
                            </p>
                            <p>
                                El cuarto integrante es el más “pequeño”, moderno, fanático del detalle y la prolijidad, de los más cautos y precavidos a la hora de largar su opinión.
                            </p>
                            <p className="font-medium text-white text-lg py-2">
                                Cuatro socios, que junto a un gran equipo, hoy producen en su propia fábrica 6 estilos de Cerveza Medalla: Golden, Red Ipa, Rock Ipa, Honey, Stout y Scottish.
                            </p>
                            
                            <div className="pt-4">
                                <p className="text-amber-500 italic text-xl md:text-2xl brand-font">
                                    "Que la travesía y el desafío te persigan siempre para lanzarte a un próximo vuelo… Sólo échale valentía."
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        );

        const BeerCatalog = () => {
            const [selected, setSelected] = useState(null);
            const [isClosing, setIsClosing] = useState(false);

            const handleClose = () => {
                setIsClosing(true);
                setTimeout(() => {
                    setSelected(null);
                    setIsClosing(false);
                }, 300);
            };

            return (
                // SECCIÓN ADAPTADA AL ALTO DEL DISPOSITIVO
                // h-screen: Ocupa todo el alto de la ventana.
                // pt-24 md:pt-28: Descuenta el espacio de la barra de navegación.
                // flex flex-col: Permite distribuir el espacio verticalmente.
                <section id="beers" className="bg-slate-900 content-section reveal h-screen md:min-h-screen md:h-auto 2xl:h-screen flex flex-col pt-24 md:pt-28 pb-4 overflow-hidden md:overflow-visible 2xl:overflow-hidden">
                    <div className="container mx-auto px-6 2xl:w-full 2xl:max-w-[98%] 2xl:px-10 transition-all duration-500 flex-1 flex flex-col min-h-0">
                        
                        {/* TÍTULO POSICIONADO ARRIBA CON ESPACIADO */}
                        <div className="flex items-center gap-4 mt-2 mb-4 shrink-0">
                            <div className="h-1 w-12 bg-amber-500 shrink-0"></div>
                            <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-white whitespace-nowrap">NUESTRAS CREACIONES</h2>
                        </div>
                        
                        {/* CONTENEDOR DE TARJETAS - Ocupa el espacio restante (flex-1) */}
                        <div className="flex-1 min-h-0 flex md:grid md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-6 gap-6 2xl:gap-4 overflow-x-auto md:overflow-visible snap-x snap-mandatory pb-2 -mx-6 px-6 md:mx-0 md:px-0 no-scrollbar items-stretch h-[60vh] md:h-auto 2xl:h-full">
                            {beersData.map((beer) => (
                                <div key={beer.id} className="min-w-[85vw] sm:min-w-[350px] md:min-w-0 snap-center rounded-xl overflow-hidden flex flex-col h-full md:h-auto 2xl:h-full group relative transition-transform duration-500 lg:hover:scale-[1.02] bg-transparent border border-transparent hover:border-amber-500/10">
                                    
                                    {/* Imagen de la lata */}
                                    {/* MD/LG: Altura fija grande (h-80/h-96). Móvil/2XL: Flex relativo y max-h */}
                                    <div className="flex-1 relative flex items-center justify-center overflow-hidden min-h-0 md:h-80 lg:h-96 2xl:h-auto">
                                        <div className="absolute inset-0 flex items-center justify-center md:static md:flex md:w-full md:h-full">
                                            <img 
                                                src={beer.img} 
                                                alt={beer.name} 
                                                className="max-h-[105%] md:max-h-[75%] 2xl:max-h-[105%] w-auto object-contain p-0 z-0 relative transition-transform duration-500 mx-auto" 
                                                loading="lazy" 
                                                onError={(e) => { e.target.style.display = 'none'; e.target.nextSibling.style.display = 'flex'; }} 
                                            />
                                            <div className="absolute inset-0 hidden flex items-center justify-center bg-black/20"><Icon name="Beer" size={64} className="text-white/50" /></div>
                                        </div>
                                    </div>

                                    <div className="p-4 shrink-0 flex flex-col justify-end relative z-10">
                                        
                                        <div className="flex flex-col gap-3 mb-4">
                                            {/* 1. Información (Métricas) */}
                                            <div className="flex justify-center items-center gap-2 border-b border-slate-700/50 pb-3">
                                                <div className="px-2 text-center cursor-help group/metric" title={TOOLTIPS.ABV}>
                                                    <span className="block text-slate-500 text-[10px] font-bold uppercase tracking-wider group-hover/metric:text-amber-500 transition-colors">ABV</span>
                                                    <span className="text-sm font-bold text-white">{beer.abv}</span>
                                                </div>
                                                <div className="w-px h-6 bg-slate-700/50"></div>
                                                <div className="px-2 text-center cursor-help group/metric" title={TOOLTIPS.IBU}>
                                                    <span className="block text-slate-500 text-[10px] font-bold uppercase tracking-wider group-hover/metric:text-amber-500 transition-colors">IBU</span>
                                                    <span className="text-sm font-bold text-white">{beer.ibu}</span>
                                                </div>
                                                <div className="w-px h-6 bg-slate-700/50"></div>
                                                <div className="px-2 text-center cursor-help group/metric" title={TOOLTIPS.SRM}>
                                                    <span className="block text-slate-500 text-[10px] font-bold uppercase tracking-wider group-hover/metric:text-amber-500 transition-colors">SRM</span>
                                                    <span className="text-sm font-bold text-white">{beer.srm}</span>
                                                </div>
                                            </div>

                                            {/* 2. Imagen del Título */}
                                            <div className="flex justify-center items-center h-10">
                                                <img src={beer.titleImg} alt={beer.name} className="h-full w-auto object-contain drop-shadow-lg transition-transform group-hover:scale-105" />
                                            </div>
                                        </div>
                                        
                                        {/* Botón */}
                                        <button onClick={() => setSelected(beer)} className="w-full py-3 border border-slate-600 hover:bg-amber-500 hover:border-amber-500 hover:text-slate-900 rounded transition-all text-xs uppercase tracking-wider font-bold cursor-pointer">Ver Detalles</button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                    {selected && (
                        <ModalPortal>
                            <div 
                                className={`fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm ${isClosing ? 'animate-fadeOut' : 'animate-fadeIn'}`} 
                                onClick={handleClose}
                            >
                                <div className="relative max-w-5xl w-full flex justify-center items-center p-4" onClick={e => e.stopPropagation()}>
                                    <button onClick={handleClose} className="absolute top-4 right-4 z-50 p-2 bg-black/50 hover:bg-amber-600 rounded-full text-white transition-colors cursor-pointer shadow-lg border border-white/20">
                                        <Icon name="X" size={32} />
                                    </button>
                                    <img 
                                        src={selected.detailImg} 
                                        alt={`Detalle ${selected.name}`} 
                                        className={`max-h-[85vh] w-auto object-contain drop-shadow-2xl ${isClosing ? 'animate-zoomOut' : 'animate-zoomIn'}`} 
                                    />
                                </div>
                            </div>
                        </ModalPortal>
                    )}
                </section>
            );
        };

        const TheProcess = () => {
            const [activeStep, setActiveStep] = useState(null); 

            const steps = [
                { 
                    title: "Molienda", 
                    icon: "Wheat", 
                    desc: "El grano de malta se muele cuidadosamente para romper la cáscara lo justo y necesario. Buscamos exponer el almidón interior sin convertirlo en harina, asegurando así un filtrado perfecto y una extracción de azúcares óptima.", 
                    stat: "100% Malta Seleccionada" 
                },
                { 
                    title: "Maceración", 
                    icon: "Thermometer", 
                    desc: "Mezcla precisa de malta molida y agua caliente en nuestro macerador. Controlamos las temperaturas al grado exacto para activar las enzimas naturales, convirtiendo los almidones complejos en azúcares fermentables que darán cuerpo y alcohol.", 
                    stat: "65°C - 68°C Controlados" 
                },
                { 
                    title: "Hervido", 
                    icon: "Flame", 
                    desc: "El mosto se hierve vigorosamente para esterilizarlo y concentrarlo. Es aquí donde ocurre la magia del lúpulo: lo añadimos en diferentes etapas para otorgar ese amargor característico, sabor profundo y aromas cítricos o florales.", 
                    stat: "60-90 min de Ebullición" 
                },
                { 
                    title: "Fermentación", 
                    icon: "FlaskConical", 
                    desc: "El mosto enfriado pasa a los fermentadores donde sembramos las levaduras. Durante días, estos microorganismos trabajan incansablemente transformando los azúcares en alcohol y CO2, definiendo el perfil final de cada estilo.", 
                    stat: "7 a 14 días de Maduración" 
                },
                { 
                    title: "Enlatado", 
                    icon: "Package", 
                    desc: "Tras una maduración en frío para clarificar y redondear sabores, la cerveza se envasa protegiéndola rigurosamente del oxígeno y la luz. Así garantizamos que llegue a tu copa con la misma frescura con la que salió de nuestro tanque.", 
                    stat: "Conservación a 4°C" 
                }
            ];

            const desktopIndex = activeStep === null ? 0 : activeStep;

            const StepDetail = ({ step, index }) => (
                <div className="relative bg-slate-900/80 backdrop-blur-md rounded-3xl border border-slate-700 shadow-2xl overflow-hidden h-full flex flex-col">
                    <div className="absolute top-0 right-0 opacity-5 -translate-y-1/4 translate-x-1/4 pointer-events-none">
                        <Icon name={step.icon} size={400} />
                    </div>
                    
                    <div className="relative z-10 h-full p-8 md:p-12 animate-fadeIn" key={index}>
                        <div className="flex flex-col lg:grid lg:grid-cols-2 gap-8 lg:gap-12 h-full">
                            
                            <div className="flex flex-col justify-between shrink-0">
                                <div className="border-b border-slate-800/50 pb-6">
                                    <span className="block text-6xl md:text-8xl font-bold text-amber-500/20 font-mono leading-none mb-4">0{index + 1}</span>
                                    <h3 className="text-4xl md:text-6xl font-bold text-white brand-font tracking-wide leading-none">{step.title}</h3>
                                </div>
                                
                                <div className="mt-6 lg:mt-0">
                                    <div className="bg-slate-950/60 p-6 rounded-2xl border-l-4 border-amber-500 w-full shadow-lg">
                                        <span className="text-slate-400 text-xs uppercase tracking-widest mb-2 flex items-center gap-2">
                                            <Icon name="CheckCircle" size={14} className="text-amber-500" /> Dato Clave
                                        </span>
                                        <span className="text-2xl font-bold text-white tracking-tight break-words">{step.stat}</span>
                                    </div>
                                </div>
                            </div>

                            <div className="flex flex-col justify-center lg:border-l lg:border-slate-800/50 lg:pl-12 min-h-0">
                                <div className="overflow-y-auto custom-scrollbar pr-4 max-h-full">
                                    <p className="text-lg md:text-2xl text-slate-300 leading-relaxed font-light">
                                        {step.desc}
                                    </p>
                                </div>
                            </div>

                        </div>
                    </div>
                    
                    <div className="absolute bottom-0 left-0 h-1.5 bg-slate-800 w-full">
                        <div className="h-full bg-gradient-to-r from-amber-600 to-amber-400 transition-all duration-500 ease-out" style={{ width: "100%" }}></div>
                    </div>
                </div>
            );

            return (
                <section id="process" className="bg-slate-950 relative overflow-hidden content-section reveal pt-24 md:pt-28 pb-8">
                    <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-slate-900 to-slate-950"></div>
                    <div className="container mx-auto px-6 relative z-10 h-full flex flex-col justify-center">
                        
                        {/* Header Ajustado: Centrado y con Icono al inicio */}
                        <div className="flex flex-col md:flex-row items-center justify-center gap-6 mb-8 shrink-0 text-center md:text-left">
                            <div className="p-4 rounded-full bg-slate-800/50 border border-slate-700 backdrop-blur-sm animate-float shrink-0">
                                <Icon name="FlaskConical" size={40} className="text-amber-500" />
                            </div>
                            <div>
                                <h2 className="text-5xl font-bold text-white mb-2">LA <span className="gold-text">ALQUIMIA</span></h2>
                                <p className="text-slate-400 text-xl font-light">Del grano a la copa.</p>
                            </div>
                        </div>

                        <div className="flex flex-col lg:h-[70vh]">
                            
                            <div className="hidden lg:flex flex-col h-full gap-8">
                                <div className="flex-1 overflow-hidden min-h-0">
                                    <StepDetail step={steps[desktopIndex]} index={desktopIndex} />
                                </div>

                                <div className="shrink-0 flex flex-row gap-4 justify-between bg-slate-900/50 p-2 rounded-2xl border border-slate-800/50">
                                    {steps.map((step, idx) => {
                                        const isActive = activeStep === idx || (activeStep === null && idx === 0);
                                        return (
                                            <button 
                                                key={idx} 
                                                onClick={() => setActiveStep(idx)}
                                                className={`flex-1 flex items-center justify-center gap-3 p-4 rounded-xl transition-all duration-300 group ${isActive ? 'bg-amber-500 text-slate-900 shadow-lg shadow-amber-500/20' : 'bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-white'}`}
                                            >
                                                <Icon name={step.icon} size={24} className={`transition-transform duration-300 ${isActive ? 'scale-110' : 'group-hover:scale-110'}`} />
                                                <span className={`font-bold uppercase tracking-wider text-sm hidden xl:block ${isActive ? '' : 'opacity-70 group-hover:opacity-100'}`}>
                                                    {step.title}
                                                </span>
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            <div className="lg:hidden flex flex-col gap-3">
                                {steps.map((step, idx) => (
                                    <div key={idx} className={`rounded-xl overflow-hidden border transition-all duration-300 shrink-0 ${activeStep === idx ? 'border-amber-500/50 bg-slate-900' : 'border-slate-800 bg-slate-900/30 hover:bg-slate-800'}`}>
                                        <button 
                                            onClick={() => setActiveStep(activeStep === idx ? null : idx)}
                                            className="w-full flex items-center gap-4 p-5 text-left group cursor-pointer focus:outline-none"
                                        >
                                            <div className={`p-3 rounded-lg transition-all duration-300 ${activeStep === idx ? 'bg-amber-500 text-slate-900 shadow-[0_0_15px_rgba(245,158,11,0.3)]' : 'bg-slate-800 text-slate-500 group-hover:text-amber-500'}`}>
                                                <Icon name={step.icon} size={22} />
                                            </div>
                                            <div className="flex-1">
                                                <h4 className={`font-bold text-lg transition-colors ${activeStep === idx ? 'text-white' : 'text-slate-400 group-hover:text-slate-200'}`}>{step.title}</h4>
                                            </div>
                                            <div className={`ml-auto transition-transform duration-300 ${activeStep === idx ? 'rotate-90 text-amber-500' : 'text-slate-600'}`}>
                                                 <Icon name="ChevronRight" size={18} />
                                            </div>
                                        </button>

                                        <div className={`grid transition-[grid-template-rows] duration-500 ease-in-out ${activeStep === idx ? 'grid-rows-[1fr] opacity-100' : 'grid-rows-[0fr] opacity-0'}`}>
                                            <div className="overflow-hidden">
                                                <div className="p-5 pt-0 border-t border-slate-800/50">
                                                    <p className="text-slate-300 text-sm leading-relaxed mt-4 mb-4">{step.desc}</p>
                                                    <div className="w-full bg-slate-950/50 p-4 rounded-xl border border-slate-800 flex items-center gap-3">
                                                        <div className="text-amber-500"><Icon name="CheckCircle" size={20} /></div>
                                                        <div>
                                                            <span className="text-[10px] text-slate-500 uppercase tracking-wider block">Dato Clave</span>
                                                            <span className="font-bold text-white text-sm">{step.stat}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>

                        </div>
                    </div>
                </section>
            );
        };

        const KegRentals = () => (
            <section id="kegs" className="min-h-screen flex flex-col justify-center relative overflow-hidden bg-slate-950 border-t border-slate-900 content-section reveal py-12 pt-24 md:pt-28 md:pb-16">
                <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"></div>
                <div className="container mx-auto px-6 relative z-10">
                     <div className="flex flex-col md:flex-row items-center justify-between gap-12 mb-16">
                        <div className="max-w-2xl"><h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-4 whitespace-nowrap">LLEVA LA FIESTA <span className="text-amber-500">A CASA</span></h2><p className="text-slate-400 text-lg">Alquiler de choperas y barriles para eventos.</p></div>
                        <button className="bg-green-600 hover:bg-green-500 text-white px-8 py-4 rounded-full font-bold transition-all flex items-center gap-3 shadow-lg shadow-green-900/50 hover:scale-105 cursor-pointer"><Icon name="Phone" size={24} /> Reservar por WhatsApp</button>
                    </div>
                    <div className="flex md:grid md:grid-cols-3 gap-6 md:gap-8 overflow-x-auto md:overflow-visible snap-x snap-mandatory pb-8 -mx-6 px-6 md:mx-0 md:px-0 no-scrollbar">
                        {kegsData.map((keg, idx) => (
                            <div key={idx} className="min-w-[85vw] sm:min-w-[350px] md:min-w-0 snap-center bg-slate-900/50 border border-slate-800 p-8 rounded-2xl hover:border-amber-500/50 transition-all group text-center relative overflow-hidden">
                                <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-amber-500 to-transparent opacity-50"></div>
                                <div className="mb-6 inline-flex justify-center items-center w-24 h-24 rounded-full bg-slate-800 group-hover:bg-amber-500/10 transition-colors"><Icon name="Package" size={keg.iconSize} className="text-slate-400 group-hover:text-amber-500 transition-colors" /></div>
                                <h3 className="text-3xl font-bold text-white mb-2">{keg.size}</h3>
                                <div className="inline-block bg-slate-800 text-amber-500 text-sm px-3 py-1 rounded-full mb-4 font-mono font-bold">{keg.serves}</div>
                                <div className="mb-4 text-sm font-bold text-green-400 bg-green-900/30 inline-block px-2 py-1 rounded border border-green-500/30">Stock: +{keg.stock}</div>
                                <p className="text-slate-400 mb-6">Ideal para {keg.ideal}</p>
                                <button className="text-white border-b border-amber-500 hover:text-amber-500 transition-colors text-sm uppercase tracking-wider pb-1 cursor-pointer">Consultar Disponibilidad</button>
                            </div>
                        ))}
                    </div>
                </div>
            </section>
        );

        const BeerFinder = () => {
            const [filter, setFilter] = useState('all');
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedLocation, setSelectedLocation] = useState(null);
            const [showMobileList, setShowMobileList] = useState(false); // Estado para controlar la lista en móvil
            const mapContainerRef = useRef(null);
            const mapInstanceRef = useRef(null);
            const markersRef = useRef([]);

            const filteredPartners = useMemo(() => {
                return partnersData.filter(p => {
                    // FILTRO MEJORADO: Compara con minúsculas y también revisa tildes si es necesario (simple 'includes' por ahora)
                    const typeLower = p.type.toLowerCase();
                    const filterLower = filter.toLowerCase();
                    
                    const matchesType = filter === 'all' || typeLower.includes(filterLower) || (filter === 'restaurante' && typeLower.includes('resto'));
                    const matchesSearch = p.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                          p.location.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                          p.address.toLowerCase().includes(searchTerm.toLowerCase());
                    return matchesType && matchesSearch;
                });
            }, [filter, searchTerm]);

            useEffect(() => {
                if (!mapInstanceRef.current && mapContainerRef.current) {
                    const map = L.map(mapContainerRef.current).setView([-31.3665, -64.2375], 10); // Centrado en Córdoba (Base) pero se ajustará
                    
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                        maxZoom: 19,
                    }).addTo(map);

                    setTimeout(() => map.invalidateSize(), 100);
                    mapInstanceRef.current = map;
                }

                const map = mapInstanceRef.current;
                if (map) {
                    markersRef.current.forEach(marker => marker.remove());
                    markersRef.current = [];

                    const bounds = L.latLngBounds();
                    
                    filteredPartners.forEach(partner => {
                        // Lógica de Marcadores Diferenciada
                        const isOfficial = partner.isOfficial;
                        const size = isOfficial ? 60 : 40;
                        const zIndex = isOfficial ? 1000 : 1;
                        
                        // Estilo: Oficiales dorados, Partners oscuros
                        const markerHtml = isOfficial 
                            ? `<div style="background-color: #fbbf24; width: ${size}px; height: ${size}px; border-radius: 50%; border: 3px solid #fff; box-shadow: 0 0 20px rgba(251, 191, 36, 0.8); display: flex; align-items: center; justify-content: center; overflow: hidden; animation: pulse 2s infinite;">
                                    <img src="${logoUrl}" style="width: 80%; height: 80%; object-fit: contain; filter: brightness(0);" /> 
                               </div>`
                            : `<div style="background-color: #0f172a; width: ${size}px; height: ${size}px; border-radius: 50%; border: 2px solid #fbbf24; box-shadow: 0 0 15px rgba(251, 191, 36, 0.5); display: flex; align-items: center; justify-content: center; overflow: hidden;">
                                    <img src="${logoUrl}" style="width: 80%; height: 80%; object-fit: contain;" />
                               </div>`;

                        const customIcon = L.divIcon({
                            className: 'custom-div-icon',
                            html: markerHtml,
                            iconSize: [size, size],
                            iconAnchor: [size/2, size/2]
                        });

                        const marker = L.marker([partner.lat, partner.lng], { icon: customIcon, zIndexOffset: zIndex })
                            .addTo(map)
                            .on('click', () => setSelectedLocation(partner));
                        
                        markersRef.current.push(marker);
                        bounds.extend([partner.lat, partner.lng]);
                    });

                    if (filteredPartners.length > 0) {
                        map.fitBounds(bounds, { padding: [50, 50] });
                    }
                }
            }, [filteredPartners]);

            return (
                // Se usa h-[100dvh] para asegurar que ocupe exactamente la pantalla y el flex-1 funcione
                <section id="locator" className="h-[100dvh] flex flex-col justify-center bg-slate-900 content-section reveal pt-24 md:pt-28 pb-4 lg:pb-8">
                    <div className="container mx-auto px-6 flex flex-col h-full">
                        
                        {/* Header Ajustado: Centrado y con Icono al inicio */}
                        <div className="flex flex-col md:flex-row items-center justify-center gap-4 mb-4 lg:mb-6 shrink-0 text-center md:text-left">
                            <div className="p-2 rounded-full bg-slate-800 border border-slate-700 shrink-0">
                                <Icon name="Map" size={24} className="text-amber-500" />
                            </div>
                            <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-white whitespace-nowrap">PUNTOS DE <span className="gold-text">ENCUENTRO</span></h2>
                        </div>
                        
                        {/* Barra de Controles: Buscador + Filtros */}
                        <div className="flex flex-col lg:flex-row items-center justify-between gap-4 mb-4 shrink-0 z-30 relative">
                            
                            {/* Buscador (Izquierda en desktop) */}
                            <div className="relative w-full lg:w-96">
                                <input 
                                    type="text" 
                                    placeholder="Buscar por nombre o zona..." 
                                    value={searchTerm}
                                    onChange={(e) => {
                                        setSearchTerm(e.target.value);
                                        setShowMobileList(true); 
                                    }}
                                    onFocus={() => setShowMobileList(true)}
                                    className="w-full bg-slate-800 border border-slate-700 rounded-full py-2.5 px-5 pl-10 text-white text-sm focus:border-amber-500 outline-none transition-colors shadow-lg"
                                />
                                <div className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-500"><Icon name="Search" size={16} /></div>
                                {showMobileList && (
                                    <button 
                                        onClick={() => setShowMobileList(false)}
                                        className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white lg:hidden bg-slate-700 rounded-full p-1"
                                    >
                                        <Icon name="X" size={12} />
                                    </button>
                                )}
                            </div>

                            {/* Filtros (Derecha en desktop) */}
                            <div className="flex gap-2 w-full lg:w-auto overflow-x-auto no-scrollbar pb-1 lg:pb-0 justify-start lg:justify-end px-1">
                                <button onClick={() => setFilter('all')} className={`px-4 py-2 rounded-full text-xs font-bold transition-colors cursor-pointer whitespace-nowrap ${filter === 'all' ? 'bg-amber-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>Todos</button>
                                <button onClick={() => setFilter('fábrica')} className={`px-4 py-2 rounded-full text-xs font-bold transition-colors cursor-pointer whitespace-nowrap ${filter === 'fábrica' ? 'bg-amber-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>Fábrica</button>
                                <button onClick={() => setFilter('bar')} className={`px-4 py-2 rounded-full text-xs font-bold transition-colors cursor-pointer whitespace-nowrap ${filter === 'bar' ? 'bg-amber-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>Bares</button>
                                <button onClick={() => setFilter('restaurante')} className={`px-4 py-2 rounded-full text-xs font-bold transition-colors cursor-pointer whitespace-nowrap ${filter === 'restaurante' ? 'bg-amber-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>Restaurantes</button>
                                <button onClick={() => setFilter('tienda')} className={`px-4 py-2 rounded-full text-xs font-bold transition-colors cursor-pointer whitespace-nowrap ${filter === 'tienda' ? 'bg-amber-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>Tiendas</button>
                            </div>
                        </div>

                        {/* Área Principal: Mapa y Lista */}
                        <div className="flex-1 flex flex-col lg:flex-row gap-6 min-h-0 relative">
                            
                            {/* Lista de Lugares (Panel Izquierdo en Desktop, Flotante en Móvil) */}
                            <div className={`
                                transition-all duration-300 ease-in-out flex flex-col
                                absolute inset-0 z-20 lg:static lg:z-0
                                bg-slate-900/95 lg:bg-transparent backdrop-blur-xl lg:backdrop-blur-none
                                border border-slate-700 lg:border-none rounded-2xl lg:rounded-none p-4 lg:p-0
                                ${showMobileList ? 'flex' : 'hidden lg:flex'}
                                lg:w-5/12
                            `}>
                                {/* Header Móvil */}
                                <div className="flex justify-between items-center lg:hidden mb-4 shrink-0">
                                    <span className="text-white font-bold text-sm">Resultados ({filteredPartners.length})</span>
                                    <button onClick={() => setShowMobileList(false)} className="text-amber-500 text-xs font-bold flex items-center gap-1">
                                        Ver Mapa <Icon name="ChevronRight" size={12} />
                                    </button>
                                </div>
                                
                                {/* Grid de Tarjetas Compactas */}
                                <div className="overflow-y-auto custom-scrollbar pr-2 flex-1">
                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                        {filteredPartners.map((partner, idx) => (
                                            <div key={idx} className="glass p-4 rounded-lg hover:bg-slate-800 transition-all border-l-4 border-transparent hover:border-amber-500 cursor-pointer group h-32 flex flex-col justify-between" onClick={() => {
                                                if(mapInstanceRef.current) {
                                                    mapInstanceRef.current.setView([partner.lat, partner.lng], 16);
                                                    setSelectedLocation(partner);
                                                    setShowMobileList(false);
                                                }
                                            }}>
                                                <div>
                                                    <div className="flex justify-between items-start mb-1">
                                                        <h3 className="text-sm font-bold text-white group-hover:text-amber-500 transition-colors truncate pr-2" title={partner.name}>{partner.name}</h3>
                                                        <span className="text-[10px] font-bold uppercase tracking-wider bg-slate-950 text-slate-400 px-1.5 py-0.5 rounded shrink-0">{partner.type}</span>
                                                    </div>
                                                    <div className="flex items-center gap-1.5 text-slate-400 text-xs mb-2">
                                                        <Icon name="MapPin" size={12} className="shrink-0" /> 
                                                        <span className="truncate" title={partner.address + ', ' + partner.location}>{partner.address}, {partner.location}</span>
                                                    </div>
                                                </div>
                                                <div className="flex flex-wrap gap-1 mt-auto overflow-hidden h-5">
                                                    {partner.features.slice(0, 2).map((f, i) => (
                                                        <span key={i} className="text-[9px] bg-amber-500/10 text-amber-500 border border-amber-500/20 px-1.5 py-0.5 rounded whitespace-nowrap">{f}</span>
                                                    ))}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Mapa (Visible por defecto en móvil gracias a flex-1, ocupa el espacio restante) */}
                            <div className="flex-1 w-full h-full rounded-2xl overflow-hidden border border-slate-700 shadow-2xl z-0 relative">
                                <div ref={mapContainerRef} className="w-full h-full" style={{isolation: 'isolate'}}></div>
                            </div>
                        </div>
                    </div>

                    {selectedLocation && (
                        <ModalPortal>
                            <div className="fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fadeIn" onClick={() => setSelectedLocation(null)}>
                                <div className="bg-slate-900 rounded-2xl border border-amber-500 p-8 max-w-md w-full relative shadow-2xl" onClick={e => e.stopPropagation()}>
                                    <button onClick={() => setSelectedLocation(null)} className="absolute top-4 right-4 text-slate-400 hover:text-white cursor-pointer"><Icon name="X" /></button>
                                    
                                    <div className="text-center mb-6">
                                        <div className="w-20 h-20 mx-auto mb-4 bg-slate-950 rounded-full flex items-center justify-center border-2 border-amber-500 shadow-[0_0_20px_rgba(251,191,36,0.2)]">
                                            <img src={logoUrl} className="w-12 h-12 object-contain" />
                                        </div>
                                        <h3 className="text-2xl font-bold text-white mb-2 brand-font tracking-wide">{selectedLocation.name}</h3>
                                        <span className="bg-amber-500/20 text-amber-500 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-widest border border-amber-500/30">{selectedLocation.type}</span>
                                    </div>
                                    
                                    <div className="space-y-6 mb-8">
                                        <div className="flex items-start gap-4 text-slate-300 bg-slate-800/50 p-4 rounded-lg border border-slate-700">
                                            <div className="text-amber-500 mt-1"><Icon name="MapPin" /></div>
                                            <div>
                                                <p className="font-bold text-white uppercase text-xs tracking-wider mb-1">Ubicación</p>
                                                <p className="text-sm">{selectedLocation.address}, {selectedLocation.location}</p>
                                            </div>
                                        </div>
                                        <div className="flex items-start gap-4 text-slate-300 bg-slate-800/50 p-4 rounded-lg border border-slate-700">
                                            <div className="text-amber-500 mt-1"><Icon name="Beer" /></div>
                                            <div>
                                                <p className="font-bold text-white uppercase text-xs tracking-wider mb-1">En Canilla / Stock</p>
                                                <p className="text-sm">{selectedLocation.varieties.join(", ")}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <button className="w-full bg-amber-600 hover:bg-amber-500 text-white font-bold py-4 rounded-lg transition-all uppercase tracking-widest shadow-lg hover:shadow-amber-500/20 cursor-pointer flex justify-center items-center gap-2" onClick={() => window.open(`https://www.google.com/maps/dir/?api=1&destination=${selectedLocation.lat},${selectedLocation.lng}`, '_blank')}>
                                        <Icon name="Map" size={18} /> Cómo llegar
                                    </button>
                                </div>
                            </div>
                        </ModalPortal>
                    )}
                </section>
            );
        };

        const InfoSection = () => {
            // --- FAQ STATE ---
            const [openIndex, setOpenIndex] = useState(null);

            // FAQ Data
            const faqs = [ 
                { q: "¿Son Pet Friendly?", a: "¡Absolutamente! En nuestro patio exterior las mascotas son bienvenidas." }, 
                { q: "¿Tienen opciones sin TACC?", a: "Sí, contamos con opciones gastronómicas certificadas y sidra tirada para celíacos." }, 
                { q: "¿Tienen Happy Hour?", a: "Sí, todos los días de 18 a 20hs en pintas seleccionadas." },
                { q: "¿Realizan recarga de Growlers?", a: "Sí, podés traer tu botellón a cualquiera de nuestras sucursales o fábricas y te lo recargamos en el momento." },
                { q: "¿Hacen envíos a domicilio?", a: "Realizamos envíos de latas y packs a todo el país a través de nuestra tienda online oficial." }
            ];

            return (
                // SECCIÓN FAQ ADAPTADA
                // Mobile: min-h-screen para cubrir todo el viewport + menu.
                // Desktop: Diseño más ancho aprovechando el espacio horizontal.
                <section id="faq" className="relative content-section reveal scroll-mt-0 bg-slate-900 flex flex-col pt-24 md:pt-32 min-h-screen"> 
                    
                    {/* Fondos Ambientales */}
                    <div className="absolute inset-0 bg-amber-900/10 z-0 pointer-events-none"></div>
                    <div className="absolute inset-0 bg-gradient-to-b from-slate-900 via-transparent to-slate-900 z-0 pointer-events-none"></div>

                    <div className="relative z-10 container mx-auto px-6 flex-1 flex flex-col h-full">
                        
                        {/* Header de Sección - Centrado */}
                        <div className="flex flex-col items-center justify-center gap-4 mb-10 shrink-0">
                            <div className="p-3 rounded-full bg-amber-500/10 border border-amber-500/20 animate-float">
                                <Icon name="HelpCircle" size={32} className="text-amber-400" />
                            </div>
                            <div className="text-center max-w-2xl">
                                <h2 className="text-3xl md:text-5xl font-bold text-white mb-3 brand-font tracking-wide">PREGUNTAS FRECUENTES</h2>
                                <p className="text-slate-400 text-sm md:text-base">Todo lo que necesitas saber para disfrutar tu experiencia Medalla.</p>
                            </div>
                        </div>

                        {/* Grid Content Responsivo */}
                        {/* Mobile: Flex col simple (1 columna). 
                            Desktop: Grid de 2 columnas (masonry-like feel) aprovechando el ancho. */}
                        <div className="flex-1 w-full max-w-6xl mx-auto pb-24 md:pb-12">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 items-start align-top">
                                {faqs.map((item, idx) => (
                                    <div key={idx} className="border border-slate-700/50 rounded-xl bg-slate-800/40 hover:bg-slate-800/70 transition-all duration-300 backdrop-blur-sm overflow-hidden group">
                                        <button 
                                            onClick={() => setOpenIndex(openIndex === idx ? null : idx)} 
                                            className="w-full flex justify-between items-center p-6 text-left cursor-pointer outline-none select-none"
                                        >
                                            <span className={`font-bold text-sm md:text-lg pr-4 transition-colors ${openIndex === idx ? 'text-amber-500' : 'text-white group-hover:text-amber-200'}`}>
                                                {item.q}
                                            </span>
                                            <span className={`shrink-0 bg-slate-900 rounded-full p-1 text-amber-500 border border-slate-700 transition-transform duration-300 ${openIndex === idx ? 'rotate-180 bg-amber-500/10 border-amber-500' : 'rotate-0'}`}>
                                                <Icon name="ChevronRight" size={20} className={openIndex === idx ? "rotate-90" : ""} />
                                            </span>
                                        </button>
                                        
                                        <div 
                                            className={`grid transition-[grid-template-rows] duration-300 ease-out ${openIndex === idx ? 'grid-rows-[1fr]' : 'grid-rows-[0fr]'}`}
                                        >
                                            <div className="overflow-hidden">
                                                <div className="p-6 pt-0 text-slate-300 text-sm md:text-base leading-relaxed border-t border-dashed border-slate-700/50 mt-0">
                                                    <div className="pt-4">{item.a}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        const EventsSchedule = () => {
            const [activeIndex, setActiveIndex] = useState(0);
            const [selectedGalleryEvent, setSelectedGalleryEvent] = useState(null); // Nuevo estado para el modal de galería

            const upcomingEvents = [
                { date: "15 NOV", title: "Noche de Jazz & Stout", desc: "Saxofón en vivo acompañado de nuestra Noche Eterna.", icon: "Music", img: "https://image.pollinations.ai/prompt/jazz%20band%20bar%20night%20dark%20atmosphere?width=800&height=600&nologo=true" },
                { date: "22 NOV", title: "Cata de IPAs", desc: "Descubre los secretos del lúpulo con nuestro maestro cervecero.", icon: "Beer", img: "https://image.pollinations.ai/prompt/craft%20beer%20tasting%20flight%20hops?width=800&height=600&nologo=true" },
                { date: "10 DIC", title: "Aniversario Medalla", desc: "¡Cumplimos 5 años! Banda sorpresa y cerveza dorada ilimitada.", icon: "Award", img: "https://image.pollinations.ai/prompt/brewery%20anniversary%20party%20night?width=800&height=600&nologo=true" }
            ];

            const pastEvents = [
                { date: "31 OCT", title: "Halloween Spooky Night", img: "https://image.pollinations.ai/prompt/halloween%20party%20bar%20costumes%20dark?width=300&height=300&nologo=true" },
                { date: "21 SEP", title: "Fiesta de la Primavera", img: "https://image.pollinations.ai/prompt/spring%20beer%20garden%20sunny%20people?width=300&height=300&nologo=true" },
                { date: "20 JUL", title: "Día del Amigo", img: "https://image.pollinations.ai/prompt/friends%20toasting%20beer%20bar%20night?width=300&height=300&nologo=true" }
            ];

            return (
                <section id="events" className="bg-slate-900 content-section reveal py-12 pt-24 md:pt-28 pb-12">
                    <div className="container mx-auto px-6">
                        
                        {/* Título Principal - Agenda Medalla */}
                        <div className="flex items-center gap-4 mb-8 md:mb-12">
                            <div className="h-1 w-12 bg-amber-500"></div>
                            <h2 className="text-4xl font-bold text-white brand-font">AGENDA MEDALLA</h2>
                        </div>

                        {/* Contenedor Dividido en Desktop */}
                        <div className="flex flex-col lg:flex-row gap-8 lg:h-[500px]">
                            
                            {/* IZQUIERDA: CARRUSEL PRÓXIMOS EVENTOS (65% ancho en desktop) */}
                            <div className="lg:w-[65%] relative group h-96 lg:h-auto rounded-3xl overflow-hidden shadow-2xl border border-slate-700 bg-slate-800">
                                
                                {/* Badge Flotante */}
                                <div className="absolute top-6 left-6 z-30 bg-amber-500 text-slate-900 text-xs font-bold px-3 py-1.5 rounded uppercase tracking-widest shadow-lg">
                                    Próxima Fecha
                                </div>

                                {/* Slides */}
                                {upcomingEvents.map((evt, idx) => (
                                    <div key={idx} className={`absolute inset-0 transition-all duration-700 ease-in-out ${idx === activeIndex ? 'opacity-100 scale-100 z-10' : 'opacity-0 scale-105 z-0'}`}>
                                        {/* Imagen de Fondo con Overlay */}
                                        <img src={evt.img} alt={evt.title} className="w-full h-full object-cover" />
                                        <div className="absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-900/60 to-transparent"></div>
                                        
                                        {/* Contenido del Evento */}
                                        <div className="absolute bottom-0 left-0 w-full p-8 md:p-10">
                                            <div className="flex items-center gap-3 mb-3 text-amber-400">
                                                <Icon name={evt.icon} className="animate-bounce" />
                                                <span className="font-mono text-lg font-bold tracking-tighter">{evt.date}</span>
                                            </div>
                                            <h3 className="text-3xl md:text-5xl font-bold text-white mb-3 brand-font leading-none">{evt.title}</h3>
                                            <p className="text-slate-300 text-sm md:text-lg max-w-lg line-clamp-2 md:line-clamp-none">{evt.desc}</p>
                                        </div>
                                    </div>
                                ))}

                                {/* Controles del Carrusel - Ajustado: Arriba en móvil, Abajo en Desktop */}
                                <div className="absolute top-6 right-6 md:top-auto md:bottom-8 md:right-8 z-30 flex gap-3">
                                    <button 
                                        onClick={() => setActiveIndex(prev => prev > 0 ? prev - 1 : upcomingEvents.length - 1)} 
                                        className="p-3 bg-black/30 hover:bg-amber-500 text-white hover:text-slate-900 rounded-full backdrop-blur-md border border-white/10 transition-all cursor-pointer"
                                    >
                                        <Icon name="ChevronRight" className="rotate-180" size={20} />
                                    </button>
                                    <button 
                                        onClick={() => setActiveIndex(prev => prev < upcomingEvents.length - 1 ? prev + 1 : 0)} 
                                        className="p-3 bg-black/30 hover:bg-amber-500 text-white hover:text-slate-900 rounded-full backdrop-blur-md border border-white/10 transition-all cursor-pointer"
                                    >
                                        <Icon name="ChevronRight" size={20} />
                                    </button>
                                </div>
                            </div>

                            {/* DERECHA: EVENTOS PASADOS (35% ancho en desktop) */}
                            <div className="lg:w-[35%] flex flex-col min-h-[300px]">
                                {/* Título Secundario - Separado visualmente */}
                                <div className="mb-4 flex items-center justify-between pb-2 border-b border-slate-800">
                                    <span className="text-slate-500 font-bold uppercase tracking-widest text-xs">Bitácora de Noches</span>
                                    <span className="text-slate-600 text-[10px] font-mono">ARCHIVO 2024</span>
                                </div>
                                
                                {/* Lista Creativa Vertical */}
                                <div className="flex-1 flex flex-col gap-3 overflow-y-auto custom-scrollbar pr-2">
                                    {pastEvents.map((evt, idx) => (
                                        <div 
                                            key={idx} 
                                            onClick={() => setSelectedGalleryEvent(evt)} // Abrir modal al hacer clic
                                            className="flex items-center gap-4 p-3 rounded-xl bg-slate-800/40 hover:bg-slate-800 border border-slate-700/30 hover:border-amber-500/30 transition-all group cursor-pointer"
                                        >
                                            {/* Thumbnail tipo Polaroid */}
                                            <div className="w-16 h-16 md:w-20 md:h-20 shrink-0 relative rotate-2 group-hover:rotate-0 transition-transform duration-300 bg-slate-200 p-1 rounded-sm shadow-lg">
                                                <img src={evt.img} alt={evt.title} className="w-full h-full object-cover filter grayscale group-hover:grayscale-0 transition-all" />
                                            </div>
                                            
                                            <div className="flex flex-col">
                                                <span className="text-[10px] font-bold text-amber-600 bg-amber-900/10 px-2 py-0.5 rounded w-fit mb-1">{evt.date}</span>
                                                <h4 className="text-white font-bold text-sm md:text-base leading-tight group-hover:text-amber-500 transition-colors">{evt.title}</h4>
                                                <div className="flex items-center gap-1 text-[10px] text-slate-500 mt-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                                    <Icon name="Camera" size={10} /> Ver Galería
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                    {/* Botón ver más */}
                                    <button className="mt-auto w-full py-3 text-xs uppercase tracking-widest text-slate-500 hover:text-white border border-dashed border-slate-700 hover:border-slate-500 rounded-xl transition-colors">
                                        Ver Archivo Completo
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>

                    {/* Modal de Galería de Eventos */}
                    <EventGalleryModal 
                        isOpen={!!selectedGalleryEvent} 
                        onClose={() => setSelectedGalleryEvent(null)} 
                        event={selectedGalleryEvent} 
                    />
                </section>
            );
        };

        const Footer = () => (
            <footer className="bg-slate-900 border-t border-slate-800 text-slate-400 text-sm reveal relative z-10">
                <div className="w-full max-w-7xl mx-auto px-6 md:px-12">
                    
                    <div className="min-h-[100dvh] md:min-h-0 flex flex-col justify-between md:block py-8 md:py-20">
                        
                        <div className="md:hidden"></div>

                        {/* Grid Container: Contenido Principal */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-12 md:gap-8 items-start w-full">
                            
                            {/* 1. Comunidad (Ahora Primero - Izquierda) */}
                            <div className="flex flex-col items-center md:items-start w-full">
                                <h4 className="text-white font-bold uppercase tracking-widest mb-6 text-sm md:text-base border-b-2 border-amber-500/20 pb-2 inline-block text-center md:text-left">Comunidad</h4>
                                <div className="flex justify-center md:justify-start gap-6 w-full">
                                    <a href="#" className="bg-slate-800 p-4 rounded-full hover:bg-amber-500 hover:text-slate-900 transition-all hover:scale-110 shadow-lg group">
                                        <Icon name="Facebook" size={24} className="group-hover:scale-110 transition-transform" />
                                    </a>
                                    <a href="#" className="bg-slate-800 p-4 rounded-full hover:bg-amber-500 hover:text-slate-900 transition-all hover:scale-110 shadow-lg group">
                                        <Icon name="Instagram" size={24} className="group-hover:scale-110 transition-transform" />
                                    </a>
                                    <a href="#" className="bg-slate-800 p-4 rounded-full hover:bg-amber-500 hover:text-slate-900 transition-all hover:scale-110 shadow-lg group">
                                        <Icon name="Twitter" size={24} className="group-hover:scale-110 transition-transform" />
                                    </a>
                                </div>
                            </div>

                            {/* 2. Contacto (Centro) */}
                            <div className="flex flex-col items-center w-full">
                                <h4 className="text-white font-bold uppercase tracking-widest mb-6 text-sm md:text-base border-b-2 border-amber-500/20 pb-2 inline-block">Contacto</h4>
                                <ul className="space-y-5 md:space-y-6 text-base md:text-lg w-full flex flex-col items-center">
                                    <li className="flex items-center gap-3 hover:text-amber-500 transition-colors cursor-default group">
                                        <div className="p-2 bg-slate-800 rounded-full group-hover:bg-amber-500/10 transition-colors shrink-0">
                                            <Icon name="MapPin" size={20} className="text-amber-600" />
                                        </div>
                                        <span>Av. Siempre Viva 742</span>
                                    </li>
                                    <li className="flex items-center gap-3 hover:text-amber-500 transition-colors cursor-default group">
                                        <div className="p-2 bg-slate-800 rounded-full group-hover:bg-amber-500/10 transition-colors shrink-0">
                                            <Icon name="Phone" size={20} className="text-amber-600" />
                                        </div>
                                        <span>+54 9 11 1234-5678</span>
                                    </li>
                                    <li className="flex items-center gap-3 hover:text-amber-500 transition-colors cursor-default group">
                                        <div className="p-2 bg-slate-800 rounded-full group-hover:bg-amber-500/10 transition-colors shrink-0">
                                            <Icon name="CheckCircle" size={20} className="text-amber-600" />
                                        </div>
                                        <span>info@medalla.com</span>
                                    </li>
                                </ul>
                            </div>

                            {/* 3. Marca (Ahora Último - Derecha) */}
                            <div className="flex flex-col items-center md:items-end">
                                {/* Logo y Texto lado a lado en todas las pantallas, ajustando tamaños */}
                                <div className="flex flex-row items-center gap-4 text-amber-500 transition-all mb-4">
                                    <img src={logoUrl} alt="Logo Footer" className="h-16 w-16 md:h-28 md:w-28 object-contain transition-all" />
                                    <span className="font-bold tracking-[0.2em] brand-font text-3xl md:text-5xl text-white transition-all">MEDALLA</span>
                                </div>
                                {/* Derechos Reservados justo debajo: Más grande y visible en desktop */}
                                <p className="text-xs md:text-sm text-slate-600 md:text-slate-400 font-light tracking-wide whitespace-nowrap transition-colors text-center md:text-right">
                                    &copy; {new Date().getFullYear()} Cervecería Medalla. Todos los derechos reservados.
                                </p>
                            </div>

                        </div>
                        
                        {/* Legales (Centrado abajo) */}
                        <div className="border-t border-slate-800 mt-8 md:mt-16 pt-8 w-full flex justify-center">
                            <div className="text-[10px] md:text-xs font-bold text-amber-700/80 uppercase tracking-widest px-4 py-2 rounded-lg border border-amber-900/20 bg-amber-900/5 select-none text-center">
                                Beber con moderación. Prohibida su venta a menores de 18 años.
                            </div>
                        </div>

                    </div>
                </div>
            </footer>
        );

        // --- MAIN APP ---
        const App = () => {
            // Inicialización Lazy del estado verificada para evitar desenfoque en refresh
            const [ageVerified, setAgeVerified] = useState(() => {
                try {
                    return window.localStorage.getItem('medalla_age_verified') === 'true';
                } catch (e) {
                    return false;
                }
            });
            const [toasts, setToasts] = useState([]);
            // Carrito persistente
            const [cart, setCart] = useLocalStorage('medalla_cart', []);
            const [isCartOpen, setIsCartOpen] = useState(false);
            const [isSommelierOpen, setIsSommelierOpen] = useState(false); // Estado para el modal de Sommelier
            const [confirmation, setConfirmation] = useState({ type: null, isOpen: false });

            useScrollReveal();

            const addToast = (msg) => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message: msg }]);
            };
            const removeToast = (id) => setToasts(prev => prev.filter(t => t.id !== id));
            
            const addToCart = (prod) => {
                setCart(prev => {
                    const existing = prev.find(item => item.id === prod.id);
                    if (existing) {
                        addToast(`+1 ${prod.name} al pedido.`);
                        return prev.map(item => 
                            item.id === prod.id ? { ...item, quantity: (item.quantity || 1) + 1 } : item
                        );
                    }
                    addToast(`${prod.name} agregado.`);
                    return [...prev, { ...prod, quantity: 1 }];
                });
                setIsCartOpen(true);
            };

            const updateQuantity = (id, delta) => {
                setCart(prev => prev.map(item => {
                    if (item.id === id) {
                        return { ...item, quantity: Math.max(0, (item.quantity || 1) + delta) };
                    }
                    return item;
                }).filter(item => item.quantity > 0));
            };

            const removeFromCart = (id) => {
                setCart(prev => prev.filter(item => item.id !== id));
            };

            const openClearCartModal = () => setConfirmation({ type: 'clear', isOpen: true });
            const openCheckoutModal = () => setConfirmation({ type: 'checkout', isOpen: true });
            const closeConfirmation = () => setConfirmation({ type: null, isOpen: false });

            const handleConfirmAction = () => {
                if (confirmation.type === 'clear') {
                    setCart([]);
                    addToast("Carrito vaciado.");
                } else if (confirmation.type === 'checkout') {
                    addToast("¡Compra realizada con éxito!");
                    setCart([]);
                    setIsCartOpen(false);
                }
                closeConfirmation();
            };

            const total = useMemo(() => cart.reduce((sum, i) => sum + (i.price * (i.quantity || 1)), 0), [cart]);
            const cartItemCount = useMemo(() => cart.reduce((sum, i) => sum + (i.quantity || 1), 0), [cart]);

            return (
                <div className="min-h-screen flex flex-col relative">
                    <AgeGate onVerify={() => setAgeVerified(true)} />
                    {ageVerified && <RadioMedalla />}
                    <ToastContainer toasts={toasts} remove={removeToast} />
                    
                    <ConfirmModal 
                        isOpen={confirmation.isOpen}
                        onClose={closeConfirmation}
                        onConfirm={handleConfirmAction}
                        title={confirmation.type === 'clear' ? "Vaciar Carrito" : "Confirmar Compra"}
                        message={confirmation.type === 'clear' ? "¿Estás seguro de que deseas eliminar todos los productos?" : `¿Deseas procesar el pago por $${total.toLocaleString()}?`}
                        confirmText={confirmation.type === 'clear' ? "Sí, vaciar" : "Sí, comprar"}
                        isDestructive={confirmation.type === 'clear'}
                    />

                    <SommelierModal 
                        isOpen={isSommelierOpen}
                        onClose={() => setIsSommelierOpen(false)}
                    />

                    <CartDrawer 
                        isOpen={isCartOpen} 
                        onClose={() => setIsCartOpen(false)} 
                        cart={cart} 
                        updateQuantity={updateQuantity}
                        remove={removeFromCart} 
                        clearCart={openClearCartModal}
                        onCheckout={openCheckoutModal}
                        total={total}
                        addToCart={addToCart} // Pasamos la función addToCart al Drawer
                    />
                    {/* Aplicamos la clase blur-transition y controlamos el blur dinámicamente */}
                    <div className={`blur-transition ${ageVerified ? "filter-none" : "blur-xl pointer-events-none h-screen overflow-hidden"}`}>
                        <ScrollProgress />
                        <Navbar 
                            cartCount={cartItemCount} 
                            onOpenCart={() => setIsCartOpen(true)} 
                            onOpenSommelier={() => setIsSommelierOpen(true)}
                        />
                        <Hero />
                        <AboutUs />
                        <BeerCatalog />
                        <TheProcess />
                        <KegRentals />
                        {/* <MerchStore /> ELIMINADO DEL FLUJO */} 
                        <BeerFinder />
                        {/* <FoodMenu /> ELIMINADO DEL FLUJO */}
                        {/* <LoyaltyClub /> ELIMINADO DEL FLUJO */}
                        <EventsSchedule />
                        {/* <ImageGallery /> ELIMINADO DEL FLUJO (Integrado en EventsSchedule) */}
                        <InfoSection />
                        {/* <Testimonials /> ELIMINADO DEL FLUJO */}
                        {/* <FAQ /> ELIMINADO DEL FLUJO - UNIDO EN INFOSECTION */}
                        <Footer />
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>